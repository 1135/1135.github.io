<!-- Navigation component for reuse across sites -->
<nav class="main-navigation">
    <div class="nav-container">
        <div class="nav-brand">
            <a href="/index.html" class="nav-logo" id="nav-home-link">1135</a>
        </div>
        <div class="nav-notes">
            <div class="nav-dropdown">
                <button class="nav-dropdown-btn">
                    <span data-i18n="nav_tools">Â∑•ÂÖ∑ÈõÜÂêà</span>
                    <span>‚ñº</span>
                </button>
                <div class="nav-dropdown-content" id="navDropdown">
                    <div class="dropdown-section">
                        <h4 class="dropdown-section-title" data-i18n="nav_web_security">WebÊîªÈò≤Â∑•ÂÖ∑</h4>
                        <a href="../exec/index.html" class="dropdown-link" data-i18n="tool_exec_title">ÂëΩ‰ª§ÂèòÂΩ¢Â∑•ÂÖ∑</a>
                        <a href="../xss_weaponization/index.html" class="dropdown-link"
                            data-i18n="tool_xss_title">XSSÊ≠¶Âô®Âåñ</a>
                        <a href="../diff_tool/index.html" class="dropdown-link" data-i18n="tool_diff_title">DiffÂ∑•ÂÖ∑</a>
                        <a href="../ip_tool/index.html" class="dropdown-link" data-i18n="tool_ip_title">IPÂ∑•ÂÖ∑ÁÆ±</a>
                    </div>
                    <div class="dropdown-section">
                        <h4 class="dropdown-section-title" data-i18n="nav_general">ÈÄöÁî®Â∑•ÂÖ∑</h4>
                        <a href="../markdown2pdf/index.html" class="dropdown-link"
                            data-i18n="tool_md2pdf_title">Markdown to PDF</a>
                        <a href="../universal_editor/index.html" class="dropdown-link"
                            data-i18n="tool_editor_title">ÈÄöÁî®ÁºñËæëÂô®</a>
                        <a href="../totp-generator/index.html" class="dropdown-link"
                            data-i18n="tool_totp_title">TOTPÁîüÊàêÂô®</a>
                        <a href="https://gchq.github.io/CyberChef/" class="dropdown-link" target="_blank">
                            <span data-i18n="tool_cyberchef_title">CyberChef</span>
                            <span style="font-size: 0.75em; opacity: 0.7;" data-i18n="third_party">(Á¨¨‰∏âÊñπ)</span>
                        </a>
                        <a href="https://hemmelig.app/" class="dropdown-link" target="_blank">
                            <span data-i18n="tool_hemmelig_title">Hemmelig</span>
                            <span style="font-size: 0.75em; opacity: 0.7;" data-i18n="third_party">(Á¨¨‰∏âÊñπ)</span>
                        </a>
                    </div>
                    <div class="dropdown-section">
                        <h4 class="dropdown-section-title" data-i18n="nav_demos">ÊºîÁ§∫/Demo</h4>
                        <a href="../0/login.html" class="dropdown-link" data-i18n="tool_login_demo_title">ÁôªÂΩïÈ°µÈù¢ÊºîÁ§∫</a>
                        <a href="../2/download.html" class="dropdown-link" data-i18n="tool_download_title">HTML
                            Smuggling</a>
                        <a href="../3/read_clipborad.html" class="dropdown-link"
                            data-i18n="tool_clipboard_title">Ââ™Ë¥¥ÊùøËØªÂèñ</a>
                        <a href="../4/page.html" class="dropdown-link" data-i18n="tool_phishing_title">ÈíìÈ±ºÈ°µÈù¢ÊºîÁ§∫</a>
                        <a href="../5/read_localfile.html" class="dropdown-link"
                            data-i18n="tool_localfile_title">Êú¨Âú∞Êñá‰ª∂ËØªÂèñ</a>
                        <a href="../demo_postMessage/index.html" class="dropdown-link"
                            data-i18n="tool_postmessage_title">postMessageÊºèÊ¥ûÊºîÁ§∫</a>
                    </div>
                </div>
            </div>
            <button class="lang-toggle-btn">
                <span class="lang-icon">EN</span>
            </button>
            <button class="theme-toggle-btn">
                <span class="theme-icon">üåô</span>
            </button>
            <div class="notes-dropdown">
                <button class="notes-toggle-btn" data-i18n-title="notes_button_title" title="Á¨îËÆ∞">
                    üìñ
                </button>
                <div class="notes-dropdown-content">
                    <a href="https://github.com/1135/notes/blob/master/README.md" target="_blank"
                        data-i18n="nav_notes_public">üìó ÂÖ¨ÂºÄÁ¨îËÆ∞</a>
                    <a href="https://github.com/1135/notes_private/blob/master/README.md" target="_blank"
                        data-i18n="nav_notes_private">üìï ÁßÅÊúâÁ¨îËÆ∞ üîí</a>
                </div>
            </div>
        </div>
    </div>
</nav>

<script>
    // Dropdown toggle functionality
    // Dropdown toggle functionality and Path Fixing
    (function () {
        const initNavigation = function () {
            // Determine if we are in a sub-site (e.g. sites/markdown2pdf/) or at root
            const currentPath = window.location.pathname;
            const isInSites = currentPath.includes('/sites/');

            // Fix home link
            const homeLink = document.getElementById('nav-home-link');
            if (homeLink) {
                if (isInSites) {
                    // In sub-site: go up two levels to root
                    homeLink.href = '../../index.html';
                } else {
                    // At root: stay at index.html
                    homeLink.href = 'index.html';
                }
            }

            // Fix footer and other links
            const linksToFix = document.querySelectorAll('.dropdown-link, .footer-link');
            linksToFix.forEach(link => {
                const originalHref = link.getAttribute('href');
                if (!originalHref) return;

                // Skip external links
                if (originalHref.startsWith('http') || originalHref.startsWith('//')) return;

                if (isInSites) {
                    // We are in a sub-site (e.g. sites/markdown2pdf/)
                    // Adjust links based on their current depth
                    if (originalHref.startsWith('/')) {
                        // Root-relative: convert to ../../ style
                        // If we are in sites/markdown2pdf/, we need to go up 2 levels
                        link.href = '../../' + originalHref.slice(1);
                    } else if (originalHref.startsWith('../')) {
                        // Already sibling-relative, usually fine
                    }
                } else {
                    // We are at root (index.html)
                    if (originalHref.startsWith('/')) {
                        link.href = originalHref.slice(1);
                    } else if (originalHref.startsWith('../')) {
                        link.href = originalHref.replace('../', 'sites/');
                    }
                }
            });

            // Dropdown event listeners
            const dropdownBtn = document.querySelector('.nav-dropdown-btn');
            const dropdownContent = document.querySelector('.nav-dropdown-content');

            if (dropdownBtn && dropdownContent) {
                // Clone to remove old listeners
                const newBtn = dropdownBtn.cloneNode(true);
                dropdownBtn.parentNode.replaceChild(newBtn, dropdownBtn);

                newBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    dropdownContent.classList.toggle('show');
                    const notesDropdown = document.querySelector('.notes-dropdown-content');
                    if (notesDropdown) notesDropdown.classList.remove('show');
                });
            }

            const notesBtn = document.querySelector('.notes-toggle-btn');
            const notesContent = document.querySelector('.notes-dropdown-content');

            if (notesBtn && notesContent) {
                const newBtn = notesBtn.cloneNode(true);
                notesBtn.parentNode.replaceChild(newBtn, notesBtn);

                newBtn.addEventListener('click', function (e) {
                    e.stopPropagation();
                    notesContent.classList.toggle('show');
                    if (dropdownContent) dropdownContent.classList.remove('show');
                });
            }

            document.addEventListener('click', function (e) {
                if (dropdownContent && !e.target.closest('.nav-dropdown')) {
                    dropdownContent.classList.remove('show');
                }
                if (notesContent && !e.target.closest('.notes-dropdown')) {
                    notesContent.classList.remove('show');
                }
            });
            // 1. Unified Footer Injection
            const injectFooter = function () {
                // Add Back to Top button if not exists
                if (!document.getElementById('back-to-top')) {
                    const bttHTML = `
                    <div id="back-to-top" title="Back to Top">
                        <svg viewBox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path></svg>
                    </div>`;
                    document.body.insertAdjacentHTML('beforeend', bttHTML);
                }

                // Initialize Back to Top
                const btt = document.getElementById('back-to-top');
                if (btt && !btt.dataset.initialized) {
                    window.addEventListener('scroll', () => {
                        if (window.scrollY > 300) {
                            btt.classList.add('show');
                        } else {
                            btt.classList.remove('show');
                        }
                    });
                    btt.addEventListener('click', () => {
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    });
                    btt.dataset.initialized = "true";
                }

                // Remove existing footers that ARE NOT our injected footer
                const existingFooters = document.querySelectorAll('footer:not(.injected-footer), .unified-footer:not(.injected-footer)');
                existingFooters.forEach(f => f.remove());

                // Check if already injected to avoid duplication on re-runs
                if (document.querySelector('.injected-footer')) return;

                const footerHTML = `
                <footer class="unified-footer injected-footer" style="padding: 2rem 0; margin-top: 4rem; position: relative; transition: all 0.3s ease;">
                    <!-- Subtle Toggle Button (Top Center) -->
                    <button id="footer-toggle" title="Switch Footer View" style="position: absolute; top: 0; left: 50%; transform: translateX(-50%); background: transparent; border: none; color: var(--text-secondary); opacity: 0.3; font-size: 18px; cursor: pointer; padding: 2px 10px; transition: all 0.2s; z-index: 10; display: flex; align-items: center; justify-content: center; height: 20px; line-height: 1;">
                        <span class="toggle-icon" style="display: block; margin-top: -2px; color: var(--primary-color); opacity: 0.9;">‚àí</span>
                    </button>
                    <style>
                        #footer-toggle:hover { opacity: 1; color: var(--primary-color); transform: translateX(-50%) scale(1.1); }
                    </style>

                    <!-- Expanded View (Default) -->
                    <div id="footer-expanded" class="footer-content" style="max-width: 1200px; margin: 0 auto; padding: 0 2rem; display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1.8rem; text-align: left; opacity: 1; transition: opacity 0.3s;">
                        <div class="footer-section">
                            <h4 style="color: var(--primary-color); margin-bottom: 0.8rem; font-size: 0.95rem; text-transform: uppercase; letter-spacing: 1px;">1135 Tools</h4>
                            <p style="font-size: 0.75rem; line-height: 1.6; color: var(--text-secondary);">Essential developer tools for productivity and security research. Built with privacy and performance in mind.</p>
                        </div>
                        <div class="footer-section">
                            <h4 style="color: var(--primary-color); margin-bottom: 0.8rem; font-size: 0.8rem; text-transform: uppercase;">Product</h4>
                            <ul style="list-style: none; padding: 0; font-size: 0.7rem; line-height: 1.8;">
                                <li><a href="/index.html" class="footer-link" style="color: inherit; transition: color 0.2s;">Home</a></li>
                                <li><a href="/sites/legal/pricing.html" class="footer-link" style="color: inherit; transition: color 0.2s;">Pricing</a></li>
                                <li><a href="/sites/legal/about.html" class="footer-link" style="color: inherit; transition: color 0.2s;">About Us</a></li>
                                <li><a href="/sites/legal/contact.html" class="footer-link" style="color: inherit; transition: color 0.2s;">Contact</a></li>
                            </ul>
                        </div>
                        <div class="footer-section">
                            <h4 style="color: var(--primary-color); margin-bottom: 0.8rem; font-size: 0.8rem; text-transform: uppercase;">Legal</h4>
                            <ul style="list-style: none; padding: 0; font-size: 0.7rem; line-height: 1.8;">
                                <li><a href="/sites/legal/terms.html" class="footer-link" style="color: inherit; transition: color 0.2s;">Terms of Service</a></li>
                                <li><a href="/sites/legal/privacy.html" class="footer-link" style="color: inherit; transition: color 0.2s;">Privacy Policy</a></li>
                                <li><a href="/sites/legal/refund.html" class="footer-link" style="color: inherit; transition: color 0.2s;">Refund Policy</a></li>
                            </ul>
                        </div>
                        <div class="footer-section">
                            <h4 style="color: var(--primary-color); margin-bottom: 0.8rem; font-size: 0.8rem; text-transform: uppercase;">Support</h4>
                            <div class="footer-donation-icons" style="display: flex; gap: 8px; margin-bottom: 0;">
                                <a href="https://buymeacoffee.com/wi11x5" target="_blank" title="Buy me a coffee" class="donation-link" style="background: #fff; padding: 4px 8px; border-radius: 4px; display: flex; align-items: center; height: 28px;">
                                    <img src="https://cdn.buymeacoffee.com/buttons/bmc-new-btn-logo.svg" alt="Buy me a coffee" style="height: 18px;">
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Separate Copyright Bar -->
                    <div id="footer-copyright" style="max-width: 1200px; margin: 0 auto; padding: 1rem 2rem 0; border-top: 1px solid var(--border-color); text-align: center; color: var(--text-secondary); opacity: 0.6; font-size: 0.7rem; margin-top: 1rem;">
                         <p style="margin: 0;">¬© 2025 1135 Tools. All rights reserved.</p>
                    </div>

                    <!-- Simple View (Hidden by default) -->
                    <div id="footer-simple" style="display: none; text-align: center; color: var(--text-secondary); font-size: 0.8rem; padding: 1rem 0;">
                        <p style="margin: 0; display: flex; align-items: center; justify-content: center; gap: 10px;">
                            <span>arr0w1 <span style="margin: 0 4px; opacity: 0.3;">|</span> <a href="https://github.com/1135" target="_blank" class="author-link link-fix-needed" style="color: inherit; text-decoration: none; transition: color 0.2s;">1135</a></span>
                            <span style="opacity: 0.2;">|</span>
                            <span class="footer-donation-icons">
                                <a href="https://buymeacoffee.com/wi11x5" target="_blank" title="Buy me a coffee" class="donation-link" style="background: #fff; padding: 2px 6px; border-radius: 4px; display: inline-flex; align-items: center; height: 20px;">
                                    <img src="https://cdn.buymeacoffee.com/buttons/bmc-new-btn-logo.svg" alt="Buy me a coffee" style="height: 14px;">
                                </a>
                            </span>
                        </p>
                    </div>
                </footer>`;

                document.body.insertAdjacentHTML('beforeend', footerHTML);

                // Add Toggle Functionality
                const toggleBtn = document.getElementById('footer-toggle');
                const expandedView = document.getElementById('footer-expanded');
                const simpleView = document.getElementById('footer-simple');
                const toggleIcon = toggleBtn.querySelector('.toggle-icon');
                const footer = document.querySelector('.injected-footer');

                // Determine initial state
                const isCollapsed = localStorage.getItem('footer_collapsed') === 'true';

                function updateFooterState(collapsed) {
                    if (collapsed) {
                        expandedView.style.display = 'none';
                        simpleView.style.display = 'block';
                        footer.style.padding = '1rem 0';
                        toggleIcon.innerHTML = '+';
                        toggleIcon.title = "Expand";
                        toggleBtn.title = "Expand Footer";
                        // Reset/Ensure positioning for top-center
                        toggleBtn.style.top = "0";
                        toggleBtn.style.bottom = "auto";
                        toggleBtn.style.left = "50%";
                        toggleBtn.style.right = "auto";
                        toggleBtn.style.transform = "translateX(-50%)";
                        // Reset icon color for + (collapsed state)
                        toggleIcon.style.color = "var(--text-secondary)";
                        toggleIcon.style.opacity = "0.5";

                        // Hide copyright bar in simple mode
                        const copyrightBar = document.getElementById('footer-copyright');
                        if (copyrightBar) copyrightBar.style.display = 'none';

                        // Fix simple footer link
                        fixSimpleFooterLink();
                    } else {
                        expandedView.style.display = 'grid';
                        simpleView.style.display = 'none';
                        // Show copyright bar in expanded mode
                        const copyrightBar = document.getElementById('footer-copyright');
                        if (copyrightBar) copyrightBar.style.display = 'block';

                        footer.style.padding = '2rem 0';
                        toggleIcon.innerHTML = '‚àí';
                        // Set bright color for - (expanded state)
                        toggleIcon.style.color = "var(--primary-color)";
                        toggleIcon.style.opacity = "0.9";
                        toggleIcon.title = "Simplify";
                        toggleBtn.title = "Simplify Footer";
                        // Reset/Ensure positioning for top-center
                        toggleBtn.style.top = "0";
                        toggleBtn.style.bottom = "auto";
                        toggleBtn.style.left = "50%";
                        toggleBtn.style.right = "auto";
                        toggleBtn.style.transform = "translateX(-50%)";
                    }
                }

                // Helper to fix the link in the simple footer dynamically
                function fixSimpleFooterLink() {
                    const link = simpleView.querySelector('.link-fix-needed');
                    if (link) {
                        // Apply highlight effect logic
                        link.onmouseover = function () { this.style.color = 'var(--primary-color)'; };
                        link.onmouseout = function () { this.style.color = 'inherit'; };
                    }
                }

                // Initialize state
                updateFooterState(isCollapsed);

                // Click listener
                toggleBtn.addEventListener('click', () => {
                    const currentlyCollapsed = simpleView.style.display !== 'none';
                    const newState = !currentlyCollapsed;
                    localStorage.setItem('footer_collapsed', newState);
                    updateFooterState(newState);
                });

                // Add hover effects for footer links
                const footerLinks = document.querySelectorAll('.footer-link');
                footerLinks.forEach(link => {
                    link.addEventListener('mouseover', () => link.style.color = 'var(--primary-color)');
                    link.addEventListener('mouseout', () => link.style.color = 'inherit');
                });
            };

            // Only run injection once the full page is likely ready
            if (document.readyState === 'complete') {
                injectFooter();
            } else {
                window.addEventListener('load', injectFooter);
            }
        };

        // Run immediately if elements exist (dynamic load), otherwise wait
        if (document.querySelector('.nav-dropdown-btn')) {
            initNavigation();
        } else {
            document.addEventListener('DOMContentLoaded', initNavigation);
        }
    })();
</script>