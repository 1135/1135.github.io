<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.8 (453748)"/><meta name="created" content="2016-10-19 12:34:13 +0000"/><meta name="source" content="web.clip"/><meta name="source-url" content="http://wiki.wooyun.org/information:domain"/><meta name="updated" content="2016-10-19 12:34:13 +0000"/><title>information:domain [WooYun WiKi]</title></head><body><div style="-evernote-webclip:true"><br/><div style="font-size: 16px"><div style="box-sizing:border-box;font-family:sans-serif;text-size-adjust:100%;font-size:10px;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);"><div style="box-sizing:border-box;font-family:&quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif;font-size:14px;line-height:1.42857;color:rgb(51, 51, 51);background-color:rgb(255, 255, 255);"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><span style="box-sizing:border-box;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;background-color:rgb(255, 255, 255);border-radius:4px;box-shadow:rgba(0, 0, 0, 0.0470588) 0px 1px 1px;"><div style="box-sizing:border-box;"><span style="display:table;" />

                                          
              <div style="box-sizing:border-box;position:fixed;float:right;z-index:1024;top:10px;right:10px;">
                
<div style="box-sizing:border-box;margin-bottom:20px;background-color:rgb(255, 255, 255);border:1px solid transparent;border-radius:4px;box-shadow:rgba(0, 0, 0, 0.0470588) 0px 1px 1px;border-color:rgb(221, 221, 221);">
<h3 style="font-size:24px;box-sizing:border-box;padding:10px 15px;font-weight:500;line-height:1.1;margin-top:20px;margin-bottom:10px;font-family:inherit;border-bottom:1px solid transparent;border-top-left-radius:3px;border-top-right-radius:3px;color:rgb(51, 51, 51);background-color:rgb(245, 245, 245);border-color:rgb(221, 221, 221);cursor:pointer;"><i style="box-sizing:border-box;position:relative;top:1px;display:inline-block;font-family:&quot;Glyphicons Halflings&quot;;font-style:normal;font-weight:400;line-height:1;-webkit-font-smoothing:antialiased;padding-right:5px;"><span style="font-family:&quot;Glyphicons Halflings&quot;;font-style:normal;font-weight:400;line-height:1;"></span></i> <strong style="box-sizing:border-box;font-weight:400;position:relative;top:1px;display:inline-block;font-family:&quot;Glyphicons Halflings&quot;;font-style:normal;line-height:1;-webkit-font-smoothing:antialiased;"><span style="font-weight:400;font-family:&quot;Glyphicons Halflings&quot;;font-style:normal;line-height:1;"></span><span style="box-sizing:border-box;">+</span></strong></h3>

</div>

              </div>

              
              
<h1 style="box-sizing:border-box;font-size:36px;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;margin:40px 0px 20px;padding-bottom:9px;border-bottom:1px solid rgb(238, 238, 238);">企业域名收集</h1>
<div style="box-sizing:border-box;">

<p style="box-sizing:border-box;margin:0px 0px 10px;">
企业域名收集分两类：
</p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;">1、子域名收集
2、兄弟域名收集</pre>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
子域名是顶级域名（一级域名）的下一级，比如：mail.example.com和calendar.example.com是二级域example.com的两个子域，而example.com则是顶级域com的子域。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
兄弟域名这里是指同一个邮箱所注册的所有域名。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
对于收集到的兄弟域名不一定就是同一个企业的域名，但是可能性很高，非常值得尝试。
</p>

</div>

<h3 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;margin-top:20px;margin-bottom:10px;font-size:24px;">1、子域名收集</h3>
<div style="box-sizing:border-box;">
<hr style="border-left-style:initial;height:0px;margin-top:20px;margin-bottom:20px;border-width:1px 0px 0px;border-right-style:initial;border-bottom-style:initial;box-sizing:content-box;border-right-color:initial;border-bottom-color:initial;border-left-color:initial;border-image:initial;border-top-style:solid;border-top-color:rgb(238, 238, 238);"/>

</div>

<h4 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;margin-top:10px;margin-bottom:10px;font-size:18px;">1.1 利用域传送漏洞</h4>
<div style="box-sizing:border-box;">

<p style="box-sizing:border-box;margin:0px 0px 10px;">
如果利用域传送漏洞获取子域名是最快速最全的方式。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
假设test.com的DNS服务器为192.168.5.6，并且该DNS服务器有域传送的漏洞
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
手工检测方法,使用dig直接请求
</p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;">dig</span> <span style="box-sizing:border-box;">@</span>192.168.5.6 test.com axfr</pre>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
自动检测方法，调用nmap进行扫描
</p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;"><span style="box-sizing:border-box;">nmap</span> <span style="box-sizing:border-box;">--script</span> dns-zone-transfer <span style="box-sizing:border-box;">--script-args</span> dns-zone-transfer.domain=test.com <span style="box-sizing:border-box;">-p</span> <span style="box-sizing:border-box;">53</span> <span style="box-sizing:border-box;">-Pn</span> 192.168.5.6</pre>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
参考：<a href="https://web.archive.org/web/20150629034415/http://wiki.wooyun.org/doku.php?id=server:zone-transfer" title="http://wiki.wooyun.org/doku.php?id=server:zone-transfer" rel="nofollow" style="box-sizing:border-box;background-color:transparent;color:rgb(51, 122, 183);text-decoration:none;">DNS 域传送漏洞</a>
</p>

</div>

<h4 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;margin-top:10px;margin-bottom:10px;font-size:18px;">1.2 爆破子域名</h4>
<div style="box-sizing:border-box;">

<p style="box-sizing:border-box;margin:0px 0px 10px;">
如果域名没有域传送漏洞的话，可以采用最原始的爆破方式，例如尝试mail.test.com，test.test.com等等。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
现已有开源工具可供爆破子域名，如：dnsmap，目录下有程序自带的爆破的子域名列表，也可以自己添加。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
也可以使用白帽子写的开源工具，还可以递归爆破三级四级域名<a href="https://web.archive.org/web/20150629034415/https://github.com/lijiejie/subDomainsBrute" title="https://github.com/lijiejie/subDomainsBrute" rel="nofollow" style="box-sizing:border-box;background-color:transparent;color:rgb(51, 122, 183);text-decoration:none;">subDomainsBrute</a>
</p>

</div>

<h4 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;margin-top:10px;margin-bottom:10px;font-size:18px;">1.3 搜索引擎</h4>
<div style="box-sizing:border-box;">

<p style="box-sizing:border-box;margin:0px 0px 10px;">
Google与Baidu爬虫可能会爬到一些域名的子域名，可以使用site语法来限定域名查看结果中的子域名。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
例如Google中搜索：
</p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;">site:qq.com</pre>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
常用搜索技巧
</p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;">intitle   标题关键字包含
site      所在域
inurl     链接包含</pre>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
命令可以组合
例如
</p>
<pre style="line-height:1.42857;overflow:auto;font-size:13px;box-sizing:border-box;display:block;padding:9.5px;margin:0px 0px 10px;font-family:Menlo, Monaco, Consolas, &quot;Courier New&quot;, monospace;color:rgb(51, 51, 51);word-break:break-all;word-wrap:break-word;background-color:rgb(245, 245, 245);border:1px solid rgb(204, 204, 204);border-radius:4px;">    intitle:后台
    site:qq.com
    inurl:admin</pre>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
即可看到qq.com被Google收录的一些域名，可以通过程序来把所有搜到的子域名收集起来。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
已有开源程序<a href="https://web.archive.org/web/20150629034415/https://github.com/laramies/theHarvester" title="https://github.com/laramies/theHarvester" rel="nofollow" style="box-sizing:border-box;background-color:transparent;color:rgb(51, 122, 183);text-decoration:none;">theHarvester.py</a>可以做到。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
所使用的搜索引擎除了Google之外还有bing、shodan等等，并且可以在twitter与googleplus上搜索相关企业员工。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
程序为开源程序，可以自己动手改成weibo等国内社交媒体搜索。
</p>

</div>

<h4 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;margin-top:10px;margin-bottom:10px;font-size:18px;">1.4 Spider信息</h4>
<div style="box-sizing:border-box;">

<p style="box-sizing:border-box;margin:0px 0px 10px;">
除了利用公开的搜索引擎之外，也可以自己写爬虫爬目标企业的网站，遇到其子域名继续爬下去。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
这样可以收集到所有该网站上有链接过去的子域名（和搜索引擎可能有些重复）。
</p>

</div>

<h4 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;margin-top:10px;margin-bottom:10px;font-size:18px;">1.5 IP反查域名</h4>
<div style="box-sizing:border-box;">

<p style="box-sizing:border-box;margin:0px 0px 10px;">
某些情况下确定一个IP为某企业之后，可以利用一些网站的域名反查接口，查询有哪些绑定在该IP上的域名。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
例如：<a href="https://web.archive.org/web/20150629034415/http://dns.aizhan.com/" title="http://dns.aizhan.com" rel="nofollow" style="box-sizing:border-box;background-color:transparent;color:rgb(51, 122, 183);text-decoration:none;">IP反查域名</a>（在有CDN的情况下会不准确）。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
这样有可能查询到相关的子域名甚至该公司的其他域名，便可获得更多寻找更多信息的机会。
</p>

</div>

<h3 style="box-sizing:border-box;font-family:inherit;font-weight:500;line-height:1.1;color:inherit;margin-top:20px;margin-bottom:10px;font-size:24px;">2、兄弟域名</h3>
<div style="box-sizing:border-box;">
<hr style="border-left-style:initial;height:0px;margin-top:20px;margin-bottom:20px;border-width:1px 0px 0px;border-right-style:initial;border-bottom-style:initial;box-sizing:content-box;border-right-color:initial;border-bottom-color:initial;border-left-color:initial;border-image:initial;border-top-style:solid;border-top-color:rgb(238, 238, 238);"/>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
兄弟域名这里是指：whois信息同注册邮箱域名，这种查询到的域名与企业也极可能存在关系。
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
这里也有接口可以查询：
</p>

<p style="box-sizing:border-box;margin:0px 0px 10px;">
<a href="https://web.archive.org/web/20150629034415/http://whois.chinaz.com/reverse" title="http://whois.chinaz.com/reverse" rel="nofollow" style="box-sizing:border-box;background-color:transparent;color:rgb(51, 122, 183);text-decoration:none;">whois反查</a>
</p>

</div>

              

                            
            <span style="display:table;clear:both;" /></div></div></div></span></div></div></div></div></div><br/></div></body></html>